 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">  
<!--http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd-->  
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head> <title>5Ghoul : Unleashing Chaos on 5G Edge Devices</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- html,xhtml --> 
<meta name="src" content="5ghoul.tex" /> 
<link rel="stylesheet" type="text/css" href="5ghoul.css" /> 

<link rel="stylesheet" href="scale.css">
</head>
<body>
<link href="" rel="stylesheet" type="text/css">

<link target="_blank" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet" type="text/css">

<link target="_blank" href="https://cdn.jsdelivr.net/npm/@mdi/font@^3.0.0/css/materialdesignicons.min.css" rel="stylesheet">

<link target="_blank" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" rel="stylesheet" type="text/css">

<link rel="stylesheet" type="text/css" target="_blank" href="https://cdn.jsdelivr.net/npm/quasar@1.15.23/dist/quasar.min.css">

<script src="https://cdn.jsdelivr.net/npm/vue@^2.0.0/dist/vue.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/quasar@1.15.23/dist/quasar.umd.min.js"></script>


<div id="q-app">
       <div class="row items-start justify-center q-pa-md">
              <q-btn-group push style="margin-top: 10px;margin-bottom: -5px">
              <q-btn no-caps outline label="White Paper" icon-right="insert_drive_file" color="blue-grey-10"
                     @click="window.open('/disclosures/5ghoul/5ghoul.pdf');"></q-btn>
              <q-btn no-caps outline label="Attack Overview" icon-right="visibility" color="blue-grey-10"
                     @click="document.getElementById('overview').scrollIntoView();"></q-btn>
              <q-btn no-caps outline label="Targets" icon-right="scatter_plot" color="blue-grey-10"
                     @click="document.getElementById('affected-devices').scrollIntoView();"></q-btn>
              </q-btn-group>
              <q-btn-group push style="margin-top: 10px;margin-bottom: -20px">
              <q-btn no-caps outline label="Impact" icon-right="fas fa-hammer" color="blue-grey-10"
                     @click="document.getElementById('impact').scrollIntoView();"></q-btn>
              <q-btn no-caps outline label="Descriptions" icon-right="help_outline" color="blue-grey-10"
                     @click="document.getElementById('technical-description').scrollIntoView();"></q-btn>
              <q-btn no-caps outline label="5G Tooling & PoC" icon-right="sync_alt" color="blue-grey-10"
                     @click="document.getElementById('poc-tool').scrollIntoView();"></q-btn>
                     </q-btn>
              </q-btn-group>
       </div
>
  <div class="maketitle">
                                                
                                                                                                
                                                                                                

<h2 class="titleHead" style="font-size: 2.5rem;">5Ghoul&#x00A0;&#x00A0;: Unleashing Chaos on 5G Edge Devices</h2>
 <div class="author" > <span 
class="ptmr8t-x-x-120">Matheus E. Garbelini</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Zewen Shang</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Shijie Luo</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Sudipta Chattopadhyay</span><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmr8t-x-x-120">; Sumei Sun</span><sup><span 
class="zptmcmr-x-x-90">2</span></sup><span 
class="ptmr8t-x-x-120">; Ernest Kurniawan</span><sup><span 
class="zptmcmr-x-x-90">2</span></sup> <br 
class="newline" /><br 
class="newline" /><sup><span 
class="zptmcmr-x-x-90">1</span></sup><span 
class="ptmri8t-x-x-120">Singapore University of Technology and Design;</span><br 
class="newline" /><sup><span 
class="zptmcmr-x-x-90">2</span></sup><span 
class="ptmri8t-x-x-120">I2R, A*STAR </span></div><br />
  </div>
  <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Updates</h3>
 <p class="noindent" > *     <span id="textcolor2"><span 
  class="ptmb8t-">31st October of 2024</span></span><span 
  class="ptmb8t-">: </span>Our 5Ghoul DEFCON32 slides from August 10 are available <a 
  target="_blank" href="https://asset-group.github.io/disclosures/5ghoul/5GhoulDefcon32Demo.pptx" >here</a>.
  </p>
<!--l. 4--><p class="noindent" >*    <span id="textcolor1"><span 
class="ptmb8t-">17th May of 2024</span></span><span 
class="ptmb8t-">: </span>We have disclosed two more Mediatek
vulnerabilities: <a 
target="_blank" href="https://nvd.nist.gov/vuln/detail/CVE-2024-20003" >CVE-2024-20003</a> (High severity) and
<a 
target="_blank" href="https://nvd.nist.gov/vuln/detail/CVE-2024-20004" >CVE-2024-20004</a> (Medium severity). More details are provided
in Sections&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-260007.11">7.11<!--tex4ht:ref: sec:v15 --></a> and <a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-270007.12">7.12<!--tex4ht:ref: sec:v16 --></a>.
</p><!--l. 12--><p class="noindent" > *     <span id="textcolor2"><span 
class="ptmb8t-">29th December of 2023</span></span><span 
class="ptmb8t-">: </span>After <a 
target="_blank" href="https://corp.mediatek.com/product-security-bulletin/December-2023" >additional severity
assessment review</a> from MediaTek, three vulnerabilities
have been elevated from Medium to High severity rating.
(CVE-2023-32842, CVE-2023-32841 and CVE-2023-32843).
</p><!--l. 20--><p class="noindent" > *    <span id="textcolor3"><span 
class="ptmb8t-">15th December of 2023</span></span><span 
class="ptmb8t-">: </span>Our study to estimate the affected
smartphones considers phone models that employ the vulnerable
5G modems. However, certain phones may not enable the 5G
functionality. We performed further analysis to estimate the
number of smartphones that also offer 5G features and amended
the study (see Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-70004">4<!--tex4ht:ref: sec:attack-impact --></a>).
</p><!--l. 29--><p class="noindent" > *    <span id="textcolor4"><span 
class="ptmb8t-">7th December of 2023</span></span><span 
class="ptmb8t-">: </span>As of today, we disclose a total of
14 vulnerabilities (10 CVEs), of which 10 affect commercial
off-the-shelf (COTS) edge devices employing 5G modems from
<span 
class="ptmri8t-">Qualcomm </span>and <span 
class="ptmri8t-">MediaTek</span>. At least two other vulnerabilities
are not disclosed yet due to confidentiality. This page will
continue to be updated as our experiment progresses and
the embargo is lifted. For more details on each disclosed
vulnerability, please refer to Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-150007">7<!--tex4ht:ref: sec:5g-vulnerabilities --></a>. Feel free to contact us via
<a 
target="_blank" href="mailto:contact@5ghoul.com" >contact@5ghoul.com</a>.
</p><!--l. 40--><p class="noindent" > *     <span id="textcolor5"><span 
class="ptmb8t-">4th December of 2023</span></span><span 
class="ptmb8t-">: </span>Following a responsible
disclosure period, the December security bulletin of MediaTek
includes details of all MediaTek Chipsets affected by
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xmediatek-december">10</a>]</span>. Likewise, all Qualcomm
Chipsets affected by <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities are detailed in
December security bulletin of Qualcomm&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xqualcomm-december">13</a>]</span>.
</p><!--l. 49--><p class="noindent" >
</p>
  <h3 class="likesectionHead"><a 
 id="x1-2000"></a>Summary</h3>                                            <!--l. 50--><p class="noindent" >In this vulnerability disclosure report, we discuss details of
     <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;&#8211; a family of implementation-level 5G vulnerabilities.
     Such a family of vulnerabilities are present in the firmware
     implementation of 5G mobile network modems from major
     chipset vendors i.e., Qualcomm and MediaTek. Consequently,
     many 5G-capable commercial products such as smartphones,
     Customer-premises Equipment (CPE) routers and USB modems
     are potentially impacted due to the employment of vulnerable
     5G modems in such products. <span id="textcolor6"><span 
class="ptmri8t-">In total, we have found 12</span>
     <span 
class="ptmri8t-">new vulnerabilities (14 total), out of which 10 affect 5G</span>
     <span 
class="ptmri8t-">modems from Qualcomm and MediaTek.</span></span> More importantly,
     <span id="textcolor7"><span 
class="ptmri8t-">six</span></span> of these ten vulnerabilities are confirmed to have high
     severity. We also wrote a scraper to send crafted queries to
     <a 
target="_blank" href="https://www.kimovil.com/en/" target="_blank" class="url" >https://www.kimovil.com/en/</a> and to have an estimate on
     the number of smartphone models affected due to these
     vulnerabilities. We found over<span id="textcolor8"> <span 
class="ptmri8t-">710 smartphone models that are</span>
     <span 
class="ptmri8t-">currently in the market to employ the vulnerable modems.</span>
     <span 
class="ptmri8t-">Further considering the 5G capability of these phones employing</span>
     <span 
class="ptmri8t-">the vulnerable chipsets, we found over</span></span> <a 
target="_blank" href="https://asset-group.github.io/disclosures/5ghoul/filtered_5g_phones.txt" >626 phone models</a> <span id="textcolor9"><span 
class="ptmri8t-">to be</span>
     <span 
class="ptmri8t-">affected.</span></span> We emphasize that the actual number of affected models
     might be more, as firmware code is often shared across
     different modem versions. In this disclosure report, <span id="textcolor10"><span 
class="ptmri8t-">we also</span>
     <span 
class="ptmri8t-">demonstrate the exploitation of 5Ghoul</span><span 
class="ptmri8t-">&#x00A0;</span><span 
class="ptmri8t-">&#x00A0;vulnerabilities to</span>
     <span 
class="ptmri8t-">drop and freeze 5G connection on smartphones and CPE</span>
     <span 
class="ptmri8t-">routers. We also show downgrade attacks across multiple</span>
     <span 
class="ptmri8t-">smartphones that result in downgrading the 5G connection to</span>
     <span 
class="ptmri8t-">4G.</span></span>
     </p><!--l. 80--><p class="noindent" >
     </p>
         <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">1    </span> <a 
 id="x1-30001"></a>Introduction</h3>
         <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-3001r1"></a>
                                                
                                                                                                
                                                                                                
<!--l. 84--><p class="noindent" > <img 
src="figures/procedures.pdf.svg" alt="PIC"  
width="400" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;1:  </span><span  
class="content">An  Illustration  of  the  5G  Standalone  (SA)
connection procedure between legitimate (i.e., benign) gNB
and UE (e.g., 5G smartphone).</span></div><!--tex4ht:label?: x1-3001r1 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 106--><p class="indent" >  Mobile communications are indispensable in our daily lives,
and the advent of 5G networks has brought several new
opportunities for low-latency communication in critical
domains such as internet-of-things (IoT), virtual reality,
and medical and automation industries. However, potential
vulnerabilities in 5G networks can undermine trust in their
security, necessitating comprehensive validation of 5G protocol
stacks prior to deployment. In this context, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;showcases
implementation-level vulnerabilities existent in flagship 5G
modems, thus highlighting the need for tools and technologies
specifically targeted to test the robustness of 5G devices.
Moreover, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;pinpoints security vulnerabilities down to
the earliest protocol decoding and handling, further emphasizing
the requirement for validating the security of early-stage
5G communication down to data link protocols (OSI layer
2).
</p><!--l. 120--><p class="indent" >  In the following, we provide a brief overview on the
architecture of 5G system and procedures involved in 5G
communication. This is to provide the necessary background
knowledge for this disclosure report. Firstly, the 5G cellular
network architecture consists of three key components: The
gNodeB (gNB), User Equipment (UE), and Core Network. The
gNB is also known as the base station in traditional cellular
network. It serves as the access point for wireless communication
between the UE and the 5G core network. The UE refers to
end-user devices, such as smartphones and tablets (in general,
any 5G-enabled device), that connect to the 5G network through
the gNB. Lastly, the Core Network acts as the backbone of the
5G architecture by providing control and management functions,
including authentication, security, mobility management,
session establishment, and data routing between network
entities.
</p><!--l. 134--><p class="indent" >  Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r1">1<!--tex4ht:ref: fig:5g-procedures --></a> illustrates a clean connection process between a 5G
UE device (e.g., a smartphone) and a legitimate gNB. Multiple
protocols including Radio Resource Control (RRC), Non-Access
Stratum (NAS), Medium Access Control (MAC), Packet Data
Convergence Protocol (PDCP) and Radio Link Control (RLC)
from both network layer (OSI layer 3) and data link layer (OSI
layer 2) are involved to ensure that the connection is established
successfully and securely.
</p><!--l. 144--><p class="indent" >  A notable feature of currently disclosed <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities
is that they can all be <span id="textcolor11"><span 
class="ptmri8t-">fairly easy to exploit by an attacker, as no</span>
<span 
class="ptmri8t-">information about the victim&#8217;s SIM card is required.</span></span> This is
because <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities can be exploited to launch
an attack even before any NAS authentication procedure
completes. The attacks exploiting <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities
will be illustrated in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-70004">4<!--tex4ht:ref: sec:attack-impact --></a>. We discuss the availability
of the <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;PoC along with the necessary tooling in
Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130005">5<!--tex4ht:ref: sec:fuzzing-tool --></a>.
</p>
  <h4 class="likesubsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><a 
 id="x1-40001"></a>Why <span id="textcolor12"><span 
class="ptmbi8t-">5Ghoul</span><span 
class="ptmbi8t-">&#x00A0;</span><span 
class="ptmbi8t-">&#x00A0;</span></span>?</h4>                                      <!--l. 4--><p class="noindent" >The code name <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;is a combination of two words: <span 
class="ptmri8t-">(i) </span>5G
     and <span 
class="ptmri8t-">(ii) </span>Ghoul. While the connection of our work with 5G is
     clear, the word <span 
class="ptmri8t-">Ghoul </span>is derived from Arabian mythology
     (<a 
target="_blank" href="https://www.britannica.com/topic/ghoul" target="_blank" class="url" >https://www.britannica.com/topic/ghoul</a>). In popular legend,
     <span 
class="ptmri8t-">Ghoul </span>is a demon like creature which tries to distract travelers,
     and, upon successfully distracting them, the demon preys on
     them. Likewise, the <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities, when exploited, try
     to distract the UEs (i.e., smartphones and other 5G-enabled
     devices) to connect to <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;created malicious base station
     (gNB). Once connected, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities may be
     exploited to continuously launch attacks to drop the connections,
     freeze the connection that involve manual reboot or downgrade
     the 5G connectivity to 4G.
     </p><!--l. 3--><p class="noindent" >
     </p>
         <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">2    </span> <a 
 id="x1-50002"></a><a id="overview">Attack Scenario Overview</a></h3>
         <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-5001r2"></a>
                                                
                                                                                                
                                                                                                
<!--l. 18--><p class="noindent" > <img 
src="figures/attack_overview_with_output.pdf.svg" alt="PIC"  
width="800" class="medium-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;2: </span><span  
class="content">Overview of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;attack process. Once the
target  is  connected  to  the  rogue  base  station  (gNB),  the
attacker simply launches the exploit script as shown in the
command prompt with the Mobile Country Code (<span 
class="ptmri8t-">MCC</span>) and
the Mobile Network Code (<span 
class="ptmri8t-">MNC</span>).</span></div><!--tex4ht:label?: x1-5001r2 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 22--><p class="indent" >  As illustrated in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5001r2">2<!--tex4ht:ref: fig:attack-model --></a>, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;makes use of an attacker
model which mimics a <span 
class="ptmri8t-">limited </span>Dolev-Yao adversary&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XkimBaseSpecComparativeAnalysis2021">8</a>,&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xhussain5GReasonerPropertyDirectedSecurity2019">6</a>,&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XgarbeliniAutomatedFuzzing4G2022a">5</a>]</span>.
This is accomplished by exposing an <span 
class="ptmri8t-">Adversary-Controlled</span>
<span 
class="ptmri8t-">Downlink channel </span>that can arbitrarily inject and/or modify
5G NR Downlink Packets generated from a real 5G stack
implementation based on OpenAirInterface&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XnikaeinOpenAirInterfaceFlexiblePlatform2014">11</a>]</span> (gNB) and
Open5GS&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xopen5gs">1</a>]</span> (5G Core Network).
</p><!--l. 37--><p class="indent" >  More importantly, <span id="textcolor13"><span 
class="ptmri8t-">the attacker does not need to be aware of</span>
<span 
class="ptmri8t-">any secret information of the target UE e.g., SIM card details, to</span>
<span 
class="ptmri8t-">reach the beginning of the NAS network registration. The attacker</span>
<span 
class="ptmri8t-">only needs to impersonate the legitimate gNB using the known</span>
<span 
class="ptmri8t-">Cell Tower connection parameters (e.g., SSB ARFCN, Tracking</span>
<span 
class="ptmri8t-">Area Code, Physical Cell ID, Point A Frequency).</span></span> This can be
easily accomplished using freely available applications like
<a 
target="_blank" href="https://play.google.com/store/apps/details?id=make.more.r2d2.google.cellular_pro&hl=en&gl=US&pli=1" >Cellular-Pro</a>. Once the attacker is sufficiently close to the target
UE and the <span 
class="ptmri8t-">Received Signal Strength Indicator </span>(RSSI) of
the adversarial gNB is higher than the legitimate gNB, the
target UE will connect to the adversarial gNB. Then, the
UE starts exchanging messages up to step 4 of Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r1">1<!--tex4ht:ref: fig:5g-procedures --></a>.
Procedures that appear later are subjected to failure since key
information from UE&#8217;s SIM card is unknown. However,
throughout the message exchanges, the adversarial gNB
(see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5001r2">2<!--tex4ht:ref: fig:attack-model --></a>) can freely manipulate downlink messages
to the target UE, opening a window of opportunities to
launch attacks at any step of the 5G NR procedures shown in
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r1">1<!--tex4ht:ref: fig:5g-procedures --></a>.
</p><!--l. 69--><p class="indent" >  In practicality, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities can be easily
exploited over-the-air by starting a malicious gNB within radio
range of the target 5G UE device (see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-5001r2">2<!--tex4ht:ref: fig:attack-model --></a>). This is a
practical setup which relies on using Software Defined Radio
(SDR) to behave as a cloned gNB. While USRP B210 used
in our setup could be recognized from afar, thus making
the attack visually noticeable, such type of equipment has
already been miniaturized to the size of a Raspberry Pi&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XVodafoneUnveilsPrototype">15</a>]</span>.
This, in turn, enables the use of SDR for visibly stealthy
attacks.
</p>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">3    </span> <a 
 id="x1-60003"></a><a id="affected-devices">Vulnerable 5G Modems and Products</a></h3>
<!--l. 7--><p class="noindent" >In this section, we provide some salient characteristics of the
found vulnerabilities and vulnerable devices.
</p><!--l. 17--><p class="noindent" ><span 
class="ptmb8t-">Vulnerability Summary: </span>The vulnerable targets used in
our evaluation and their corresponding firmware version
are outlined in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r1">1<!--tex4ht:ref: tab:setup --></a>. Additionally, Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a> outlines all
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities on 5G devices. In the first column, each
vulnerability name is identified with prefix <span 
class="ptmbi8t-">V</span>. While the first
two vulnerabilities (<span 
class="ptmbi8t-">V1 </span>and <span 
class="ptmbi8t-">V2</span>) affect an open-source UE
implementation from <span 
class="ptmri8t-">OpenAirInterface </span>project&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XnikaeinOpenAirInterfaceFlexiblePlatform2014">11</a>]</span>, the rest of
the vulnerabilities were tested on many popular 5G USB
Modems (<span 
class="ptmbi8t-">V3-V7</span>) or representative Smartphones employing
<span 
class="ptmri8t-">Qualcomm </span>or <span 
class="ptmri8t-">MediaTek </span>modems (<span 
class="ptmbi8t-">V5-V14</span>).               
                                                                                                
                                                                                                
</p><!--l. 6--><p class="indent" >  <a 
 id="x1-6001r1"></a></p><div></div 
>
                                                
                                                                                                
                                                                                                
 <div class="caption" 
><span class="id">Table&#x00A0;1: </span><span  
class="content">Devices and Monitoring used for evaluation of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities. The firmware/software is provided by vendor
or through an OS update. <span 
class="ptmri8t-">OpenAirInterface UE </span>is a software solution, not employing a 5G modem (N.A).</span></div><!--tex4ht:label?: x1-6001r1 -->
 <!--tex4ht:inline--><div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2" /></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3" /></colgroup><colgroup id="TBL-2-4g"><col 
id="TBL-2-4" /></colgroup><colgroup id="TBL-2-5g"><col 
id="TBL-2-5" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:normal; text-align:center;" id="TBL-2-1-1"  
class="td11">                                           <div class="multicolumn"  style="white-space:normal; text-align:center;"><span class="uline"><span 
class="ptmb8t-">Vendor</span></span> <span 
class="ptmb8t-">/ Product</span></div>                                                                                        </td><td  style="white-space:normal; text-align:center;" id="TBL-2-1-2"  
class="td11">    <div class="multicolumn"  style="white-space:normal; text-align:center;"><span 
class="ptmb8t-">5G Modem</span></div>         </td><td  style="white-space:normal; text-align:left;" id="TBL-2-1-3"  
class="td11"> <span 
class="ptmb8t-">Type               </span></td><td  style="white-space:normal; text-align:center;" id="TBL-2-1-4"  
class="td11">    <span 
class="ptmb8t-">Monitor         </span></td><td  style="white-space:normal; text-align:left;" id="TBL-2-1-5"  
class="td11"> <span 
class="ptmb8t-">Firmware/Software Version                   </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:normal; text-align:left;" id="TBL-2-2-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-02-2-"><td  style="white-space:normal; text-align:left;" id="TBL-02-2-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-02-3-"><td  style="white-space:normal; text-align:left;" id="TBL-02-3-1"  
class="td11"></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-02-4-"><td  style="white-space:normal; text-align:left;" id="TBL-02-4-1"  
class="td11"> <span class="uline">OpenAirInterface</span> UE                                                                                                                                                                          </td><td  style="white-space:normal; text-align:left;" id="TBL-02-4-2"  
class="td11"> N.A                           </td><td  style="white-space:normal; text-align:left;" id="TBL-02-4-3"  
class="td11"> Software         </td><td  style="white-space:normal; text-align:left;" id="TBL-02-4-4"  
class="td11"> <div class="multicolumn"  style="white-space:normal; text-align:left;">ProcessMonitor</div>    </td><td  style="white-space:normal; text-align:left;" id="TBL-02-4-5"  
class="td11"> 2023.w03                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-02-5-"><td  style="white-space:normal; text-align:left;" id="TBL-02-5-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-002-5-"><td  style="white-space:normal; text-align:left;" id="TBL-002-5-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-002-6-"><td  style="white-space:normal; text-align:left;" id="TBL-002-6-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-002-7-"><td  style="white-space:normal; text-align:left;" id="TBL-002-7-1"  
class="td11"> <span class="uline">Quectel</span> RM500Q-GL                                                                                                                                                                          </td><td  style="white-space:normal; text-align:left;" id="TBL-002-7-2"  
class="td11"> Qualcomm X55        </td><td  style="white-space:normal; text-align:left;" id="TBL-002-7-3"  
class="td11"> USB Modem  </td><td  style="white-space:normal; text-align:center;" id="TBL-002-7-4"  
class="td11"> ModemManager  </td><td  style="white-space:normal; text-align:left;" id="TBL-002-7-5"  
class="td11"> Aug 03 2021                                              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-002-8-"><td  style="white-space:normal; text-align:left;" id="TBL-002-8-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0002-8-"><td  style="white-space:normal; text-align:left;" id="TBL-0002-8-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0002-9-"><td  style="white-space:normal; text-align:left;" id="TBL-0002-9-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0002-10-"><td  style="white-space:normal; text-align:left;" id="TBL-0002-10-1"  
class="td11"> <span class="uline">Simcom</span> SIM8202G                                                                                                                                                                            </td><td  style="white-space:normal; text-align:left;" id="TBL-0002-10-2"  
class="td11"> Qualcomm X55        </td><td  style="white-space:normal; text-align:left;" id="TBL-0002-10-3"  
class="td11"> USB Modem  </td><td  style="white-space:normal; text-align:center;" id="TBL-0002-10-4"  
class="td11"> ModemManager  </td><td  style="white-space:normal; text-align:left;" id="TBL-0002-10-5"  
class="td11"> SIM8202G-M2_V1.2                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0002-11-"><td  style="white-space:normal; text-align:left;" id="TBL-0002-11-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00002-11-"><td  style="white-space:normal; text-align:left;" id="TBL-00002-11-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00002-12-"><td  style="white-space:normal; text-align:left;" id="TBL-00002-12-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00002-13-"><td  style="white-space:normal; text-align:left;" id="TBL-00002-13-1"  
class="td11"> <span class="uline">Fibocom</span> FM150-AE                                                                                                                                                                           </td><td  style="white-space:normal; text-align:left;" id="TBL-00002-13-2"  
class="td11"> Qualcomm X55        </td><td  style="white-space:normal; text-align:left;" id="TBL-00002-13-3"  
class="td11"> USB Modem  </td><td  style="white-space:normal; text-align:center;" id="TBL-00002-13-4"  
class="td11"> ModemManager  </td><td  style="white-space:normal; text-align:left;" id="TBL-00002-13-5"  
class="td11"> 89602.1000.00.04.07.20                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00002-14-"><td  style="white-space:normal; text-align:left;" id="TBL-00002-14-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000002-14-"><td  style="white-space:normal; text-align:left;" id="TBL-000002-14-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000002-15-"><td  style="white-space:normal; text-align:left;" id="TBL-000002-15-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000002-16-"><td  style="white-space:normal; text-align:left;" id="TBL-000002-16-1"  
class="td11"> <span class="uline">Telit</span> FT980m                                                                                                                                                                                       </td><td  style="white-space:normal; text-align:left;" id="TBL-000002-16-2"  
class="td11"> Qualcomm X55        </td><td  style="white-space:normal; text-align:left;" id="TBL-000002-16-3"  
class="td11"> USB Modem  </td><td  style="white-space:normal; text-align:center;" id="TBL-000002-16-4"  
class="td11"> ModemManager  </td><td  style="white-space:normal; text-align:left;" id="TBL-000002-16-5"  
class="td11"> 38.23.001-B001-P0H.000640                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000002-17-"><td  style="white-space:normal; text-align:left;" id="TBL-000002-17-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000002-17-"><td  style="white-space:normal; text-align:left;" id="TBL-0000002-17-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000002-18-"><td  style="white-space:normal; text-align:left;" id="TBL-0000002-18-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000002-19-"><td  style="white-space:normal; text-align:left;" id="TBL-0000002-19-1"  
class="td11"> <span class="uline">OnePlus</span> Nord CE 2 5G                                                                                                                                                                       </td><td  style="white-space:normal; text-align:left;" id="TBL-0000002-19-2"  
class="td11"> Dimensity 900 5G    </td><td  style="white-space:normal; text-align:left;" id="TBL-0000002-19-3"  
class="td11"> Smartphone    </td><td  style="white-space:normal; text-align:center;" id="TBL-0000002-19-4"  
class="td11">      ADB            </td><td  style="white-space:normal; text-align:left;" id="TBL-0000002-19-5"  
class="td11"> M_V3_P10                                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000002-20-"><td  style="white-space:normal; text-align:left;" id="TBL-0000002-20-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000002-20-"><td  style="white-space:normal; text-align:left;" id="TBL-00000002-20-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000002-21-"><td  style="white-space:normal; text-align:left;" id="TBL-00000002-21-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000002-22-"><td  style="white-space:normal; text-align:left;" id="TBL-00000002-22-1"  
class="td11"> <span class="uline">Xiaomi</span> Redmi K40                                                                                                                                                                             </td><td  style="white-space:normal; text-align:left;" id="TBL-00000002-22-2"  
class="td11"> Dimensity 1200 5G  </td><td  style="white-space:normal; text-align:left;" id="TBL-00000002-22-3"  
class="td11"> Smartphone    </td><td  style="white-space:normal; text-align:center;" id="TBL-00000002-22-4"  
class="td11">      ADB            </td><td  style="white-space:normal; text-align:left;" id="TBL-00000002-22-5"  
class="td11"> MOLY.NR15.R3.TC8.PR2.SP.V2.1.P70  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000002-23-"><td  style="white-space:normal; text-align:left;" id="TBL-00000002-23-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000002-23-"><td  style="white-space:normal; text-align:left;" id="TBL-000000002-23-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000002-24-"><td  style="white-space:normal; text-align:left;" id="TBL-000000002-24-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000002-25-"><td  style="white-space:normal; text-align:left;" id="TBL-000000002-25-1"  
class="td11"> <span class="uline">Asus</span> ROG Phone 5s                                                                                                                                                                            </td><td  style="white-space:normal; text-align:left;" id="TBL-000000002-25-2"  
class="td11"> Qualcomm&#x00A0;X60       </td><td  style="white-space:normal; text-align:left;" id="TBL-000000002-25-3"  
class="td11"> Smartphone    </td><td  style="white-space:normal; text-align:center;" id="TBL-000000002-25-4"  
class="td11">      ADB            </td><td  style="white-space:normal; text-align:left;" id="TBL-000000002-25-5"  
class="td11"> M3.13.24.73-Anakin2                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000002-26-"><td  style="white-space:normal; text-align:left;" id="TBL-000000002-26-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000002-26-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-26-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000002-27-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-27-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000002-28-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-28-1"  
class="td11"> <span class="uline">Samsung</span> S22 (5G)                                                                                                                                                                              </td><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-28-2"  
class="td11"> Qualcomm X65        </td><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-28-3"  
class="td11"> Smartphone    </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000002-28-4"  
class="td11">      ADB            </td><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-28-5"  
class="td11"> S901EXXU4CWCE                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000002-29-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000002-29-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000002-29-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000002-29-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000002-30-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000002-30-1"  
class="td11"></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000002-31-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000002-31-1"  
class="td11">                                                                                                      </td></tr></table>                                                                                        </div>
                                                
                                                                                                
                                                                                                
  
                                                
                                                                                                
                                                                                                
<!--l. 2--><p class="indent" >  <a 
 id="x1-6002r2"></a></p><div></div 
>
                                                
                                                                                                
                                                                                                
<div class="caption" 
><span class="id">Table&#x00A0;2: </span><span  
class="content">Summary of 5G Implementation Vulnerabilities and affected software or products.</span></div><!--tex4ht:label?: x1-6002r2 -->
<!--tex4ht:inline--><div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2" /></colgroup><colgroup id="TBL-3-3g"><col 
id="TBL-3-3" /></colgroup><colgroup id="TBL-3-4g"><col 
id="TBL-3-4" /></colgroup><colgroup id="TBL-3-5g"><col 
id="TBL-3-5" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:normal; text-align:left;" id="TBL-3-1-1"  
class="td11"> <span 
class="ptmb8t-">Implementation Vulnerability                                                                                                                                                         </span></td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-2"  
class="td11"> <span 
class="ptmb8t-">Affected Modems/Smartphones  </span></td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-3"  
class="td11">  <span 
class="ptmb8t-">Protocols    </span></td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-4"  
class="td11">     <span 
class="ptmb8t-">Impact          </span></td><td  style="white-space:normal; text-align:center;" id="TBL-3-1-5"  
class="td11">   <span 
class="ptmb8t-">CVE Status       </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:normal; text-align:left;" id="TBL-3-2-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-03-2-"><td  style="white-space:normal; text-align:left;" id="TBL-03-2-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-03-3-"><td  style="white-space:normal; text-align:left;" id="TBL-03-3-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-03-4-"><td  style="white-space:normal; text-align:left;" id="TBL-03-4-1"  
class="td11"> V1 - Invalid PUSCH Resource Allocation                                                                                                                                          </td><td  style="white-space:normal; text-align:center;" id="TBL-03-4-2"  
class="td11">           OAI UE                       </td><td  style="white-space:normal; text-align:center;" id="TBL-03-4-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-03-4-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-03-4-5"  
class="td11">     <span id="textcolor14"><span style="color: #730099">Pending </span></span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-03-5-"><td  style="white-space:normal; text-align:left;" id="TBL-03-5-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-003-5-"><td  style="white-space:normal; text-align:left;" id="TBL-003-5-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-003-6-"><td  style="white-space:normal; text-align:left;" id="TBL-003-6-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-003-7-"><td  style="white-space:normal; text-align:left;" id="TBL-003-7-1"  
class="td11"> V2 - Empty RRC dedicatedNAS-Message                                                                                                                                         </td><td  style="white-space:normal; text-align:center;" id="TBL-003-7-2"  
class="td11">           OAI UE                       </td><td  style="white-space:normal; text-align:center;" id="TBL-003-7-3"  
class="td11"> RRC, NAS   </td><td  style="white-space:normal; text-align:center;" id="TBL-003-7-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-003-7-5"  
class="td11">     <span id="textcolor15"><span style="color: #730099">Pending </span></span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-003-8-"><td  style="white-space:normal; text-align:left;" id="TBL-003-8-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0003-8-"><td  style="white-space:normal; text-align:left;" id="TBL-0003-8-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0003-9-"><td  style="white-space:normal; text-align:left;" id="TBL-0003-9-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0003-10-"><td  style="white-space:normal; text-align:left;" id="TBL-0003-10-1"  
class="td11"> V3 - Invalid RRC Setup                                                                                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0003-10-2"  
class="td11">      Fibocom FM150-AE             </td><td  style="white-space:normal; text-align:center;" id="TBL-0003-10-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-0003-10-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-0003-10-5"  
class="td11">     <span id="textcolor16">Patched</span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0003-11-"><td  style="white-space:normal; text-align:left;" id="TBL-0003-11-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00003-11-"><td  style="white-space:normal; text-align:left;" id="TBL-00003-11-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00003-12-"><td  style="white-space:normal; text-align:left;" id="TBL-00003-12-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00003-13-"><td  style="white-space:normal; text-align:left;" id="TBL-00003-13-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-00003-13-2"  
class="td11">      Simcom SIM8202G             </td><td  style="white-space:normal; text-align:center;" id="TBL-00003-13-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00003-13-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00003-13-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00003-14-"><td  style="white-space:normal; text-align:left;" id="TBL-00003-14-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000003-14-"><td  style="white-space:normal; text-align:left;" id="TBL-000003-14-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000003-15-"><td  style="white-space:normal; text-align:left;" id="TBL-000003-15-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000003-16-"><td  style="white-space:normal; text-align:left;" id="TBL-000003-16-1"  
class="td11"> V4 - Invalid RRC Reconfiguration</td><td  style="white-space:normal; text-align:center;" id="TBL-000003-16-2"  
class="td11">      Simcom SIM8202G             </td><td  style="white-space:normal; text-align:center;" id="TBL-000003-16-3"  
class="td11"> MAC, RRC  </td><td  style="white-space:normal; text-align:center;" id="TBL-000003-16-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-000003-16-5"  
class="td11">     <span id="textcolor17">Patched</span>          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000003-17-"><td  style="white-space:normal; text-align:left;" id="TBL-000003-17-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000003-17-"><td  style="white-space:normal; text-align:left;" id="TBL-0000003-17-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000003-18-"><td  style="white-space:normal; text-align:left;" id="TBL-0000003-18-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000003-19-"><td  style="white-space:normal; text-align:left;" id="TBL-0000003-19-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0000003-19-2"  
class="td11">         Telit FT980m                  </td><td  style="white-space:normal; text-align:center;" id="TBL-0000003-19-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000003-19-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000003-19-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000003-20-"><td  style="white-space:normal; text-align:left;" id="TBL-0000003-20-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000003-20-"><td  style="white-space:normal; text-align:left;" id="TBL-00000003-20-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000003-21-"><td  style="white-space:normal; text-align:left;" id="TBL-00000003-21-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000003-22-"><td  style="white-space:normal; text-align:left;" id="TBL-00000003-22-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-160007.1">7.1<!--tex4ht:ref: sec:v5 --></a>) V5 - Invalid MAC/RLC PDU</td><td  style="white-space:normal; text-align:center;" id="TBL-00000003-22-2"  
class="td11">      Simcom SIM8202G             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000003-22-3"  
class="td11"> MAC, RLC   </td><td  style="white-space:normal; text-align:center;" id="TBL-00000003-22-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000003-22-5"  
class="td11"> <span id="textcolor18">CVE-2023-33043</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000003-23-"><td  style="white-space:normal; text-align:left;" id="TBL-00000003-23-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000003-23-"><td  style="white-space:normal; text-align:left;" id="TBL-000000003-23-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000003-24-"><td  style="white-space:normal; text-align:left;" id="TBL-000000003-24-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000003-25-"><td  style="white-space:normal; text-align:left;" id="TBL-000000003-25-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-000000003-25-2"  
class="td11">      Asus ROG Phone 5s             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000003-25-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-000000003-25-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-000000003-25-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000003-26-"><td  style="white-space:normal; text-align:left;" id="TBL-000000003-26-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000003-26-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000003-26-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000003-27-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000003-27-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000003-28-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000003-28-1"  
class="td11"></td><td  style="white-space:normal; text-align:center;" id="TBL-0000000003-28-2"  
class="td11">         Telit FT980m                  </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000003-28-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000003-28-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000003-28-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000003-29-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000003-29-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000003-29-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000003-29-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000003-30-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000003-30-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000003-31-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000003-31-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-170007.2">7.2<!--tex4ht:ref: sec:v6 --></a>) V6 - NAS Unknown PDU                                                                                                                                                          </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000003-31-2"  
class="td11">      Fibocom FM150-AE             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000003-31-3"  
class="td11">    NAS        </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000003-31-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000003-31-5"  
class="td11"> <span id="textcolor19">CVE-2023-33044</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000003-32-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000003-32-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000003-32-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000003-32-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000003-33-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000003-33-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000003-34-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000003-34-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000003-34-2"  
class="td11">      Asus ROG Phone 5s             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000003-34-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000003-34-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000003-34-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000003-35-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000003-35-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000003-35-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000003-35-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000003-36-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000003-36-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000003-37-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000003-37-1"  
class="td11"></td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000003-37-2"  
class="td11">         Telit FT980m                  </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000003-37-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000003-37-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000003-37-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000003-38-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000003-38-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000003-38-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000003-38-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000003-39-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000003-39-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000003-40-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000003-40-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000003-40-2"  
class="td11">      Asus ROG Phone 5s             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000003-40-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000003-40-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000003-40-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000003-41-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000003-41-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000003-41-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000003-41-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000003-42-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000003-42-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000003-43-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000003-43-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-180007.3">7.3<!--tex4ht:ref: sec:v7 --></a>) V7 - Disabling 5G / Downgrade via RRC</td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000003-43-2"  
class="td11">      Simcom SIM8202G             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000003-43-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000003-43-4"  
class="td11"> Hang/Downgrade  </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000003-43-5"  
class="td11"> <span id="textcolor20">CVE-2023-33042</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000003-44-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000003-44-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000003-44-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000003-44-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000003-45-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000003-45-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000003-46-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000003-46-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000003-46-2"  
class="td11">      Fibocom FM150-AE             </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000003-46-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000003-46-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000003-46-5"  
class="td11">                </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000003-47-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000003-47-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000003-47-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000003-47-1"  
class="td11"> </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000003-48-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000003-48-1"  
class="td11">                                                                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000003-49-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000003-49-1"  
class="td11"></td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000003-49-2"  
class="td11">      Quectel RM500Q-GL            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000003-49-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000003-49-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000003-49-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000003-50-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000003-50-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000003-50-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000003-50-1"  
class="td11">                                                                                                  </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000003-51-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000003-51-1"  
class="td11"></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000003-52-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000003-52-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-190007.4">7.4<!--tex4ht:ref: sec:v8 --></a>) V8 - Invalid RRC Setup spCellConfig                                                                                                                                        </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000003-52-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000003-52-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000003-52-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000003-52-5"  
class="td11"> <span id="textcolor21">CVE-2023-32842</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000003-53-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000003-53-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000003-53-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000003-53-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000003-54-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000003-54-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000003-55-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000003-55-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000003-55-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000003-55-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000003-55-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000003-55-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000003-56-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000003-56-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000003-56-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000003-56-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000003-57-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000003-57-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000003-58-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000003-58-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-200007.5">7.5<!--tex4ht:ref: sec:v9 --></a>) V9 - Invalid RRC pucch CSIReportConfig                                                                                                                                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000003-58-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000003-58-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000003-58-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000003-58-5"  
class="td11"> <span id="textcolor22">CVE-2023-32844</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000003-59-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000003-59-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000003-59-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000003-59-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000003-60-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000003-60-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000003-61-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000003-61-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000003-61-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000003-61-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000003-61-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000003-61-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000003-62-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000003-62-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000003-62-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000003-62-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000003-63-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000003-63-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000003-64-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000003-64-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-210007.6">7.6<!--tex4ht:ref: sec:v10 --></a>) V10 - Invalid RLC Data Sequence                                                                                                                                             </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000003-64-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000003-64-3"  
class="td11">    RLC        </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000003-64-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000003-64-5"  
class="td11"> <span id="textcolor23">CVE-2023-20702</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000003-65-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000003-65-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000003-65-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000003-65-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000003-66-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000003-66-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000003-67-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000003-67-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000003-67-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000003-67-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000003-67-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000003-67-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000003-68-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000003-68-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000003-68-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000003-68-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000003-69-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000003-69-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000003-70-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000003-70-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-220007.7">7.7<!--tex4ht:ref: sec:v11 --></a>) V11 - Truncated RRC physicalCellGroupConfig                                                                                                                       </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000003-70-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000003-70-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000003-70-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000003-70-5"  
class="td11"> <span id="textcolor24">CVE-2023-32846</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000003-71-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000003-71-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000003-71-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000003-71-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000003-72-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000003-72-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000003-73-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000003-73-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000003-73-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000003-73-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000003-73-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000003-73-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000003-74-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000003-74-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000003-74-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000003-74-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000003-75-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000003-75-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000003-76-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000003-76-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-230007.8">7.8<!--tex4ht:ref: sec:v12 --></a>) V12 - Invalid RRC searchSpacesToAddModList                                                                                                                       </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000003-76-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000003-76-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000003-76-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000003-76-5"  
class="td11"> <span id="textcolor25">CVE-2023-32841</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000003-77-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000003-77-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000003-77-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000003-77-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000003-78-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000003-78-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000003-79-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000003-79-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000003-79-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000003-79-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000003-79-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000003-79-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000003-80-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000003-80-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000003-80-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000003-80-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000003-81-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000003-81-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000003-82-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000003-82-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-240007.9">7.9<!--tex4ht:ref: sec:v13 --></a>) V13 - Invalid RRC Uplink Config Element                                                                                                                               </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000003-82-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000003-82-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000003-82-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000003-82-5"  
class="td11"> <span id="textcolor26">CVE-2023-32843</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000003-83-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000003-83-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000003-83-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000003-83-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000003-84-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000003-84-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000003-85-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000003-85-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000003-85-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000003-85-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000003-85-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000003-85-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000003-86-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000003-86-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000003-86-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000003-86-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000003-87-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000003-87-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000003-88-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000003-88-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-250007.10">7.10<!--tex4ht:ref: sec:v14 --></a>) V14 - Null RRC Uplink Config Element                                                                                                                                 </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000003-88-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000003-88-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000003-88-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000003-88-5"  
class="td11"> <span id="textcolor27">CVE-2023-32845</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000003-89-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000003-89-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000003-89-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000003-89-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000003-90-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000003-90-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000003-91-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000003-91-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000003-91-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000003-91-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000003-91-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000003-91-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000003-92-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000003-92-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000003-92-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000003-92-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000003-93-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000003-93-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000003-94-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000003-94-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-260007.11">7.11<!--tex4ht:ref: sec:v15 --></a>) V15 - Invalid RRC CellGroup ID                                                                                                                                             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000003-94-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000003-94-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000003-94-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000003-94-5"  
class="td11"> <span id="textcolor28">CVE-2024-20003</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000003-95-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000003-95-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000003-95-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000003-95-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000003-96-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000003-96-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000003-97-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000003-97-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000000003-97-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000000003-97-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000000003-97-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-000000000000000000000000000000003-97-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000003-98-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000003-98-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000000003-98-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000000003-98-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000000003-99-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000000003-99-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000000003-100-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000000003-100-1"  
class="td11"> (<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-270007.12">7.12<!--tex4ht:ref: sec:v16 --></a>) V16 - Invalid RRC CellGroupConfig                                                                                                                                       </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000000003-100-2"  
class="td11">     OnePlus Nord CE 2 5G          </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000000003-100-3"  
class="td11">    RRC        </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000000003-100-4"  
class="td11">      DoS             </td><td  style="white-space:normal; text-align:center;" id="TBL-0000000000000000000000000000000003-100-5"  
class="td11"> <span id="textcolor29">CVE-2024-20004</span>  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-0000000000000000000000000000000003-101-"><td  style="white-space:normal; text-align:left;" id="TBL-0000000000000000000000000000000003-101-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000000003-101-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000000003-101-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000000003-102-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000000003-102-1"  
class="td11">                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000000003-103-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000000003-103-1"  
class="td11">                                                                                                      </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000000003-103-2"  
class="td11">       Xiaomi Redmi K40              </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000000003-103-3"  
class="td11">            </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000000003-103-4"  
class="td11">                </td><td  style="white-space:normal; text-align:center;" id="TBL-00000000000000000000000000000000003-103-5"  
class="td11">                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-00000000000000000000000000000000003-104-"><td  style="white-space:normal; text-align:left;" id="TBL-00000000000000000000000000000000003-104-1"  
class="td11"> </td></tr><tr><td colspan="5"></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000000003-104-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000000003-104-1"  
class="td11">                                                                                                  </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000000003-105-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000000003-105-1"  
class="td11">                                                                                                      </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-000000000000000000000000000000000003-106-"><td  style="white-space:normal; text-align:left;" id="TBL-000000000000000000000000000000000003-106-1"  
class="td11">                                                                                                      </td></tr></table>                                                                               </div>
                                                
                                                                                                
                                                                                                
  
<!--l. 35--><p class="indent" >  It is worthwhile to note that our discovered vulnerabilities
(<span id="textcolor30"><span 
class="ptmbi8t-">V3-V14</span></span>) are within the 5G baseband modem firmware. Thus,
any product employing the respective Qualcomm and MediaTek
modem firmware are affected (although the impact may vary
depending on the type of product). Moreover, during our
experiments, vulnerabilities V3 and V4 were discovered in
certain older (before 2023) firmware versions employed
in <span 
class="ptmri8t-">SIMCOM </span>and <span 
class="ptmri8t-">FIBOCOM </span>modems (see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). We
verified that such issues do not affect products (e.g., 5G
USB modems and smartphones) that had firmware with
build date in 2023. Finally, <span id="textcolor31"><span 
class="ptmbi8t-">V5-V14 affect the latest modem</span>
<span 
class="ptmbi8t-">firmware at the time of experiments and therefore, need</span>
<span 
class="ptmbi8t-">patching for the CVEs illustrated in Table</span><span 
class="ptmbi8t-">&#x00A0;</span><a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2"><span 
class="ptmbi8t-">2</span><!--tex4ht:ref: tab:summary --></a> <span 
class="ptmbi8t-">to prevent</span>
<span 
class="ptmbi8t-">exploitation.</span></span>
</p><!--l. 46--><p class="indent" >  In our findings, <span 
class="ptmri8t-">Qualcomm </span>5G USB Modems and 5G-enabled
Smartphones such as <span 
class="ptmri8t-">Asus ROG Phone 5S </span>were impacted
by a range of previously unknown vulnerabilities in the
handling of <span 
class="ptmri8t-">MAC/RLC</span>, <span 
class="ptmri8t-">RRC </span>and <span 
class="ptmri8t-">NAS </span>messages (see <span 
class="ptmbi8t-">V5-V7</span>
in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). <span 
class="ptmri8t-">All these vulnerabilities were confirmed by</span>
<span 
class="ptmri8t-">Qualcomm to have High severity. </span>MediaTek modem enabled
smartphones such as OnePlus Nord CE 2 are affected by
previously unknown vulnerabilities <span 
class="ptmbi8t-">V8-V14 </span>(see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). In
particular, vulnerabilities V10 and V11 capture memory access
violations in terms of <span 
class="ptmri8t-">null pointer dereference</span>. <span id="textcolor32"><span 
class="ptmri8t-">While most</span>
<span 
class="ptmri8t-">vulnerabilities were confirmed to have medium severity, V11-V13</span>
<span 
class="ptmri8t-">were upgraded to high severity after further security assessment</span>
<span 
class="ptmri8t-">review from MediaTek on 29th December 2023.</span></span>
</p><!--l. 74--><p class="noindent" ><span 
class="ptmb8t-">Vulnerable Procedures: </span>In summary, the <span 
class="ptmri8t-">RRC Attach </span>and
<span 
class="ptmri8t-">Authentication </span>procedures (see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-3001r1">1<!--tex4ht:ref: fig:5g-procedures --></a>) exhibited all
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities. In particular, <span 
class="ptmri8t-">RRC Attach </span>procedure,
which contains the <span 
class="ptmri8t-">RRC Connection Setup </span>message, was focus of
most vulnerabilities. Such findings are prevalent for <span 
class="ptmri8t-">OnePlus</span>
<span 
class="ptmri8t-">Nord CE 2</span>. With such <span 
class="ptmri8t-">UE </span>employing <span 
class="ptmri8t-">MediaTek Dimensity 900</span>
<span 
class="ptmri8t-">5G </span>modem, many asserts and memory-related crashes (see
Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>) were triggered during the exchange of <span 
class="ptmri8t-">RRC Setup</span>
<span 
class="ptmri8t-">Connection</span>.
</p><!--l. 88--><p class="indent" >  Lastly, all <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities were found during the
pre-authentication stage of the communication between UE and
gNB. This means that attacks exploiting <span 
class="ptmbi8t-">V1-V14 </span>do not
require any secret information from the UE&#8217;s SIM card to
be successful. Such attacks can be launched by starting a
malicious gNB with the same setup as shown in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-50002">2<!--tex4ht:ref: sec:eval --></a> (see
Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-50002">2<!--tex4ht:ref: sec:attack-model --></a>). Overall, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;not only captures 5G data
link implementation vulnerabilities (<span 
class="ptmbi8t-">V4, V5</span>, <span 
class="ptmbi8t-">V10</span>), but also
demonstrates vulnerabilities at OSI Layer 3 and above (e.g.,
<span 
class="ptmri8t-">RRC</span>, <span 
class="ptmri8t-">NAS</span>) for COTS 5G UEs.
</p><!--l. 155--><p class="noindent" ><span 
class="ptmb8t-">Triggering the Vulnerabilities: </span>Overall, the vulnerabilities
summarized in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a> are triggered by either sending a
malformed <span 
class="ptmri8t-">RRC Connection Setup </span>(albeit writing to different
RRC fields as depicted in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-8001r3">3<!--tex4ht:ref: fig:exploits-payload-rrc --></a>) or sending a malformed <span 
class="ptmri8t-">NAS</span>
<span 
class="ptmri8t-">Authentication Request</span>. In the particular case of <span 
class="ptmbi8t-">V2</span>, the <span 
class="ptmri8t-">NAS</span>
<span 
class="ptmri8t-">Authentication Request </span>is malformed such that the actual NAS
message payload is empty. In contrast, only <span 
class="ptmbi8t-">V4 </span>requires sending  both an invalid <span 
class="ptmri8t-">MAC Time Advance Command </span>and a malformed
  <span 
class="ptmri8t-">RRC Connection Setup</span>.
  </p><!--l. 171--><p class="noindent" ><span 
class="ptmb8t-">Patch Status: </span>Patching 5G modem vulnerabilities involves a
  complex process until the patches become available to end users.
  We reflect on this process in more detail in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-120004.5">4.5<!--tex4ht:ref: sec:5G-patch-process --></a>. The
  patches for vulnerabilities <span id="textcolor33"><span 
class="ptmri8t-">V5-V14</span></span> have taken reasonable time to
  be available to end users. In particular, for Android-based
  smartphones, the patches are expected to be available in
  <span id="textcolor34"><span 
class="ptmbi8t-">December 2023</span></span>. For Apple-based iPhones, however, the patch
  schedule is not aligned with the December timeline. Nonetheless,
  <span 
class="ptmri8t-">Qualcomm has confirmed that patches were available to their</span>
  <span 
class="ptmri8t-">customers (i.e., device makers) starting in August 2023. Likewise,</span>
  <span 
class="ptmri8t-">MediaTek has also stated that the patches were available</span>
  <span 
class="ptmri8t-">to their OEM partners two months before the December</span>
  <span 
class="ptmri8t-">bulletin</span><span 
class="ptmri8t-">&#x00A0;</span><span class="cite"><span 
class="ptmri8t-">&#x00A0;[</span><a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xmediatek-december"><span 
class="ptmri8t-">10</span></a><span 
class="ptmri8t-">]</span></span><span 
class="ptmri8t-">.  </span>Therefore, end users are advised to apply
  respective security updates as they become available from device
  makers.
  </p>
    <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">4    </span> <a 
 id="x1-70004"></a><a id="impact">Exploitation of </a><span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities</h3>
  <!--l. 5--><p class="noindent" >We created different concrete attacks leveraging the
  <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities. In the following, we discuss attacks that
  cause Denial of Service (DoS) or connectivity Downgrade on
  affected target devices.
  </p><!--l. 41--><p class="noindent" >
  </p>
    <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">4.1    </span> <a 
 id="x1-80004.1"></a>Exploitation on Mobile Devices</h4>
  <!--l. 42--><p class="noindent" >To test the impact of 5G vulnerabilities on mobile devices and
  hence user experience, we exploit vulnerabilities <span 
class="ptmri8t-">V5 </span>to <span 
class="ptmri8t-">V10</span>
  against <span 
class="ptmri8t-">Asus ROG Phone 5S (ARP5s)</span>, which uses Qualcomm
  Modem and <span 
class="ptmri8t-">OnePlus Nord CE</span><span 
class="ptmri8t-">&#x00A0;2 (OnePlus)</span>, which uses
  MediaTek Modem (see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r1">1<!--tex4ht:ref: tab:setup --></a>). First, when vulnerability <span 
class="ptmb8t-">V5</span>
  (see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-8001r3">3<!--tex4ht:ref: fig:attack-v5 --></a>) or <span 
class="ptmb8t-">V6 </span>is triggered on <span 
class="ptmri8t-">ARP5s</span>, its 5G modem
  immediately reboots and automatically recovers connection to
  gNB in few seconds (temporary DoS). Hence, an attacker
  exploiting <span 
class="ptmbi8t-">V5 </span>and <span 
class="ptmbi8t-">V6 </span>must continuously launch the attacks if the
  intention is to completely disrupt mobile network connectivity of
  the user. Additionally, 3G and 4G communication are also
  disrupted upon modem reboot since the modem handles all
  <span 
class="ptmri8t-">3GPP </span>related communication.
  </p>
    <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-8001r3"></a>
                                                
                                                                                                
                                                                                                
<!--l. 63--><p class="noindent" > <img 
src="figures/attack_v5_final.pdf.svg" alt="PIC"  
width="450" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;3: </span><span  
class="content">Illustration <span 
class="ptmbi8t-">V5 </span>- <span 
class="ptmri8t-">"Invalid MAC/RLC PDU"</span></span></div><!--tex4ht:label?: x1-8001r3 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 75--><p class="indent" >  More surprisingly, vulnerability <span 
class="ptmbi8t-">V7 </span>(see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-8002r4">4<!--tex4ht:ref: fig:attack-v7 --></a>) can prevent
<span 
class="ptmri8t-">ARP5s </span>to connect to any 5G network, while keeping 4G/3G
connectivity intact (<span 
class="ptmri8t-">i.e., downgrade attack</span>). Nevertheless, such
behavior of <span 
class="ptmbi8t-">V7 </span>highlights that the mobile device modem enters
an erratic state such that the user needs to manually reboot the
phone, thus power cycling the modem to fully restore 5G
connectivity. As illustrated in the Video&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-8003r1">1<!--tex4ht:ref: vid:v7 --></a>, the impact of this
attack (i.e., freezing 5G connectivity) persists even after the
attack stops. Moreover, in certain cases, manually rebooting the
phone does not restore the connectivity either, instead, the SIM
card requires to be taken out manually and then re-inserted to
ensure a hard reset on the modem.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-8002r4"></a>
                                                
                                                                                                
                                                                                                
<!--l. 95--><p class="noindent" > <img 
src="figures/attack_v7_final.pdf.svg" alt="PIC"  
width="450" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;4: </span><span  
class="content">Illustration <span 
class="ptmbi8t-">V7 </span>- <span 
class="ptmri8t-">&#8220;RRC Invalid pdcch-Config" </span></span></div><!--tex4ht:label?: x1-8002r4 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 99--><p class="indent" >  As demonstrated in Video&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-8003r1">1<!--tex4ht:ref: vid:v7 --></a>, initially, <span 
class="ptmri8t-">ARP5s </span>is connected
to a legitimate gNB (shown as <span 
class="ptmbi8t-">SUTD 00101 </span>before
the attack). We then start the malicious gNB and <span 
class="ptmri8t-">V7</span>
is triggered by starting <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;framework (exploit
<span id="textcolor35"><span 
class="pcrbo8t-">mac_sch_rrc_setup_crash_var</span></span>). <span 
class="ptmri8t-">Although the video</span>
<span 
class="ptmri8t-">illustrates the attack using a Software Defined Radio (SDR) for</span>
<span 
class="ptmri8t-">legitimate gNB, we successfully launched the attack even</span>
<span 
class="ptmri8t-">when the smartphone was connected to a commercial 5G</span>
<span 
class="ptmri8t-">base station. </span>To this end, we used the commercial base
station provided by Quanta Cloud Technology (QCT) in the
<a 
target="_blank" href="https://fcp.sutd.edu.sg/fcclab-details/" >FCCLab</a> (<a 
target="_blank" href="https://fcp.sutd.edu.sg/fcclab-details/" target="_blank" class="url" >https://fcp.sutd.edu.sg/fcclab-details/</a>) under Future
Communications Program. The attack results in manually
rebooting affected smartphones to recover any 5G connectivity,
even if connected to QCT 5G network.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-8003r1"></a>
                                                
                                                                                                
                                                                                                
<!--l. 123--><p class="noindent" >
<iframe class="table_image resize_table" width="560" height="315" 
src="https://www.youtube.com/embed/DiGqwgBCSXM?si=qdW675lyJPo8_GXg" 
frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br /> </p><div class="caption" 
><span class="id">Video&#x00A0;1: </span><span  
class="content">Illustration <span 
class="ptmbi8t-">V7 </span>- <span 
class="ptmri8t-">&#8220;RRC Invalid pdcch-Config" </span></span></div><!--tex4ht:label?: x1-8003r1 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 152--><p class="indent" >  Lastly, vulnerabilities <span 
class="ptmbi8t-">V8-V14 </span>trigger crashes on <span 
class="ptmri8t-">OnePlus</span>,
which employs <span 
class="ptmri8t-">MediaTek Dimensity 900 5G Modem</span>. More
specifically, <span 
class="ptmbi8t-">V8, V9 </span>and <span 
class="ptmbi8t-">V12-V14 </span>trigger reachable asserts in
the internal microcontroller and DSP of the 5G modem.
Likewise, <span 
class="ptmbi8t-">V10 </span>produces an invalid memory access exception
due to a <span 
class="ptmri8t-">null pointer dereference</span>. For all cases, the modem
immediately reboots and takes a few seconds to recover 5G
connectivity. Similar to vulnerabilities <span 
class="ptmbi8t-">V5 </span>and <span 
class="ptmbi8t-">V6</span>, an attacker
can continuously launch the attacks to keep disrupting all
3G/4G/5G communications on <span 
class="ptmri8t-">OnePlus</span>.
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">4.2    </span> <a 
 id="x1-90004.2"></a>Exploitation on Specialized 5G Products</h4>
<!--l. 192--><p class="noindent" >We note that vulnerabilities <span 
class="ptmbi8t-">V5</span>-<span 
class="ptmbi8t-">V14 </span>(Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>) affect 5G devices
employing Qualcomm and MediaTek modems. Thus, <span 
class="ptmbi8t-">V5</span>-<span 
class="ptmbi8t-">V14</span>
affect not only smartphones and USB modems, but also
appliances that rely on low-latency communication.
</p><!--l. 214--><p class="indent" >  To assess the practical impact of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities
beyond smartphones, we conducted exploit tests on specific 5G
UE Modems listed in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r1">1<!--tex4ht:ref: tab:setup --></a> and analyzed the impact on
applications relying on these modems. Two Qualcomm-based
Modems were configured as Customer Premises Equipment
(CPE) to evaluate the impact of <span 
class="ptmb8t-">V5 </span>to <span 
class="ptmb8t-">V7</span>. The exploitation
setup is illustrated in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-9001r5">5<!--tex4ht:ref: fig:cpe-setup-a --></a>. Specifically, in <span 
class="ptmbi8t-">Setup A </span>(see
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-9001r5">5<!--tex4ht:ref: fig:cpe-setup-a --></a>), the Telit <span 
class="ptmri8t-">FT980m </span>modem (see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>) within the
<span 
class="ptmri8t-">FT980WW </span>platform&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xcpe-platform">14</a>]</span> was tested. Such a platform provides
5G internet connectivity through its LAN port and hosts a
<span 
class="ptmri8t-">Configuration Webpage</span>. We launched continuous attacks within
radio range, exploiting vulnerabilities <span 
class="ptmbi8t-">V5 </span>and <span 
class="ptmbi8t-">V6 </span>from a
malicious gNB. <span id="textcolor36"><span 
class="ptmbi8t-">This resulted in a complete loss of internet</span>
<span 
class="ptmbi8t-">connectivity for devices connected to the FT980WW LAN</span>
<span 
class="ptmbi8t-">port, and the Configuration Webpage became inaccessible</span>
<span 
class="ptmbi8t-">due to modem reboots caused by attacks exploiting V5</span>
<span 
class="ptmbi8t-">and V6.</span></span> A demonstration of this attack is showcased in
Video&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-9002r2">2<!--tex4ht:ref: vid:cpe-attack --></a>.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-9001r5"></a>
                                                
                                                                                                
                                                                                                
<!--l. 273--><p class="noindent" > <img 
src="figures/cpe_attack_A.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;5:  </span><span  
class="content">Impact  of  exploiting  <span 
class="ptmbi8t-">V5,  V6  </span>on  <span 
class="ptmri8t-">Telit  FT980m</span>
operating as CPE Router (<span 
class="ptmb8t-">Setup A)</span></span></div><!--tex4ht:label?: x1-9001r5 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-9002r2"></a>
                                                
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 273--><p class="noindent" >
</p><!--l. 273--><p class="noindent" >
<iframe class="table_image resize_table" width="560" height="315" 
src="https://www.youtube.com/embed/_g4P7iSuFNk?si=ztrYj81H_81GbZyl" 
frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br />  </p><div class="caption" 
><span class="id">Video&#x00A0;2:    </span><span  
class="content">Demonstration    of    <span 
class="ptmri8t-">&#8220;NAS    unknown    PDU"</span>
vulnerability  on  a  Telit  CPE  Router  (CVE-2023-33043).
Youtube Video URL: <a 
target="_blank" href="https://youtu.be/_g4P7iSuFNk" >https://youtu.be/_g4P7iSuFNk</a></span></div><!--tex4ht:label?: x1-9002r2 -->
</div>
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 287--><p class="indent" >  In <span 
class="ptmbi8t-">Setup B </span>(shown in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-9003r6">6<!--tex4ht:ref: fig:cpe-setup-b --></a>), a Raspberry Pi 3B+ with
<span 
class="ptmri8t-">OpenWRT 22.03.4</span>&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xopenwrt-platform">12</a>]</span> and <span 
class="ptmri8t-">RM500Q-GL </span>5G USB Modem (see
Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6001r1">1<!--tex4ht:ref: tab:setup --></a>) were used. This setup offered better isolation against
attacks exploiting <span 
class="ptmbi8t-">V5 </span>and <span 
class="ptmbi8t-">V6 </span>since the <span 
class="ptmri8t-">Configuration Webpage</span>
was hosted by the <span 
class="ptmri8t-">Raspberry Pi 3B+ </span>processor instead of the
modem itself. This allowed the user to remotely attempt to steer
the CPE device by selecting a different mobile network to
connect.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-9003r6"></a>
                                                
                                                                                                
                                                                                                
<!--l. 306--><p class="noindent" > <img 
src="figures/cpe_attack_b.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;6:  </span><span  
class="content">Impact  of  exploiting  <span 
class="ptmbi8t-">V5,  V6  </span>on  <span 
class="ptmri8t-">RM500Q-GL</span>
modem operating as CPE Router (<span 
class="ptmb8t-">Setup B)</span></span></div><!--tex4ht:label?: x1-9003r6 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 312--><p class="indent" >  During our tests, the <span 
class="ptmri8t-">FT980-WW </span>CPE exhibited more proactive
attempts to recover 5G connectivity after attacks exploiting <span 
class="ptmbi8t-">V5</span>
and <span 
class="ptmbi8t-">V6</span>, while the <span 
class="ptmri8t-">Raspberry Pi 3B+ with OpenWRT </span>was less
proactive, often requiring manual reconnection of the 5G Modem
via <span 
class="ptmri8t-">OpenWrt&#8217;s Webpage</span>. Such a reconnection instability involves
manually rebooting via OpenWrt&#8217;s Webpage and restore proper
5G connectivity when <span 
class="ptmbi8t-">V5-V6 </span>stopped. On the contrary,
since <span 
class="ptmri8t-">FT980-WW </span>runs the web application within its 5G
Modem, the user was unable to access the <span 
class="ptmri8t-">Webpage</span>. As a
result, the user cannot steer the CPE from the malicious gNB
while the attack was still ongoing. This means the user
intervention does not apply when trying to recover from the
attack.
</p><!--l. 326--><p class="indent" >  For attack <span 
class="ptmbi8t-">V7</span>, its effects were immediate, causing the targeted
modem to disconnect from any 5G mobile network and fallback
to 4G networks, exposing potential vulnerabilities in the 4G
domain&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XkotuliakLTrackStealthyTracking2022">9</a>]</span>. This made the CPE router to likewise downgrade
its service and access the Configuration Webpage to be available
only in 4G speed.
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">4.3    </span> <a 
 id="x1-100004.3"></a>Downgrade Attacks</h4>
<!--l. 371--><p class="noindent" >While <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;reveals a set of previously unknown
implementation vulnerabilities which cause denial of
service (i.e., crash or hang), we showcase the capability of
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;exploitation tool to perform downgrade attacks. Such a
class of vulnerability is unique in its effect on modems. This is
because downgrade attacks often lead the connectivity of the user
to forcibly change, specifically from a newer network technology
(e.g., 5G NR) to an older one (e.g., LTE or below). Thus,
downgrade attacks potentially expose the user to a different set of
design or implementation issues inherently to a network
technology (e.g., 2G, 3G and 4G). In this context, vulnerability
<span 
class="ptmri8t-">V7 </span>(<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-180007.3">7.3<!--tex4ht:ref: sec:v7 --></a>) is understood as a downgrade attack because its
exploitation prevents affected devices from connecting to any 5G
network, while connection to older network technologies such as
4G is still possible.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-10001r7"></a>
                                                
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 385--><p class="noindent" >
</p><!--l. 386--><p class="noindent" > <img 
src="figures/downgrade_flooding.pdf.svg" alt="PIC"  
width="600" height="auto"  /><br /></p><div class="caption" 
><span class="id">Figure&#x00A0;7: </span><span  
class="content">Downgrade via <span 
class="ptmri8t-">NAS flooding</span>.</span></div><!--tex4ht:label?: x1-10001r7 -->
</div>
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 412--><p class="indent" >  Nevertheless, <span 
class="ptmri8t-">V7 </span>is an implementation vulnerability which only
affects devices employing Qualcomm X55/X60 modems. However,
there are &#8220;general" downgrade attacks that can potentially affect
all 5G devices due to the vulnerable components existing in the
3GPP standard itself&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#X3gpp">2</a>]</span>. During our exploration of downgrade
attacks, we were able to trigger known general downgrade
attacks&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#X5g_ue_wisec2023">3</a>]</span>. Moreover, <span id="textcolor37"><span 
class="ptmbi8t-">we exploited a new downgrade attack</span>
<span 
class="ptmbi8t-">vector (</span><span 
class="ptmb8t-">DA1</span><span 
class="ptmbi8t-">), which affects smartphones employing 5G</span>
<span 
class="ptmbi8t-">baseband modems from multiple vendors including Qualcomm</span>
<span 
class="ptmbi8t-">and MediaTek.</span></span> Specifically, we successfully launched the
new downgrade attacks on Xiaomi Redmi K40 (MediaTek
Dimensity 1200), OnePlus Nord CE 2 (MediaTek Dimensity
900 and MediaTek Dimensity 1200), Samsung Galaxy S22
(Qualcomm X65) and Asus ROG Phone 5s (Qualcomm
X60).
</p><!--l. 440--><p class="indent" >  Our downgrade attack vector <span 
class="ptmb8t-">DA1 </span>is illustrated in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10001r7">7<!--tex4ht:ref: fig:downgrade-2 --></a>
and in Video&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10002r3">3<!--tex4ht:ref: vid:downgrade --></a>. In this attack, the target device is kept in a <span 
class="ptmri8t-">NAS</span>
<span 
class="ptmri8t-">Authentication procedure </span>loop by receiving many (i.e., flooding)
<span 
class="ptmri8t-">NAS Authentication Request</span>, followed by <span 
class="ptmri8t-">NAS Deregistration</span>
<span 
class="ptmri8t-">Accept </span>many times. After the target device goes through an
arbitrary number of retries in this scenario, it falls back to
connect to the nearest 4G base station. <span 
class="ptmri8t-">Notably, the UE cannot</span>
<span 
class="ptmri8t-">re-establish the 5G connection by merely toggling the airplane</span>
<span 
class="ptmri8t-">mode; it necessitates initiating a new connection process with the</span>
<span 
class="ptmri8t-">base station. </span>Such downgrade attack highlights the capability of
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;exploitation to be used as a valuable tool for 5G NR
security testing beyond DoS vulnerabilities. Such tooling
capabilities of launching both attacks and test cases are detailed
in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-130005">5<!--tex4ht:ref: sec:fuzzing-tool --></a>.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-10002r3"></a>
                                                
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 467--><p class="noindent" >
</p><!--l. 467--><p class="noindent" >
<iframe class="table_image resize_table" width="560" height="315" 
src="https://www.youtube.com/embed/84DDy_4ofxw?si=JjKbHardORBja11w" 
frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br /> </p><div class="caption" 
><span class="id">Video&#x00A0;3:   </span><span  
class="content">Demonstration   Video   of   Downgrade   Attack
via  NAS  flooding  (see  Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10001r7">7<!--tex4ht:ref: fig:downgrade-2 --></a>).  Youtube  Video  URL:
<a 
target="_blank" href="https://youtu.be/84DDy_4ofxw" >https://youtu.be/84DDy_4ofxw</a></span></div><!--tex4ht:label?: x1-10002r3 -->
</div>
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 478--><p class="indent" >  A demonstration of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;exploitation tool triggering the
new downgrade attack is show in Video&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10002r3">3<!--tex4ht:ref: vid:downgrade --></a>. In summary, an
attacker can use the same setup as discussed in Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-50002">2<!--tex4ht:ref: sec:attack-model --></a>. The
execution of this attack requires both a legitimate 5G and 4G
base stations (<span 
class="ptmri8t-">gNB </span>and <span 
class="ptmri8t-">eNB </span>respectively). To this end, we setup,
three SDRs in total. two to simulate the legitimate base stations
and another to simulate an attacker within radio range of the
target UE (OnePlus Nord CE 2 5G).
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">4.4    </span> <a 
 id="x1-110004.4"></a>Estimating the reach of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;</h4>
<!--l. 491--><p class="noindent" >To estimate the potential number of 5G smartphones affected by
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;, we search for the model of all the smartphones
that employ vulnerable 5G modems from Qualcomm and
MediaTek. Notably, we relied on web scraping to automate the
process of finding phone models matching specific processor
chipsets. This is because mobile processor vendors usually
provide to the smartphone vendor a chipset platform that
already integrates a CPU, 5G modem, GPU, amongst other
peripherals. For example, smartphones employing a Qualcomm
processor contains a <span id="textcolor38"><span 
class="ptmbi8t-">Snapdragon 8XX Mobile Platform</span></span>, while
MediaTek-based 5G phones contains a <span id="textcolor39"><span 
class="ptmbi8t-">Dimensity XXXX</span></span>
chipset.
</p><!--l. 513--><p class="indent" >  To find potentially affected smartphone models, we based our
search on <a 
target="_blank" href="https://www.kimovil.com/en/" >Kimovil website</a>, which makes it easy to filter all
released smartphone models by a given processor chipset name.
The models of affected chipsets, in turn, can be found in
the vendor December 2023 security bulletins&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xmediatek-december">10</a>,&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xqualcomm-december">13</a>]</span>.
Nonetheless, the security bulletin of Qualcomm&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xqualcomm-december">13</a>]</span> lists other
affected (IoT) chipset platforms than used in smartphones. Thus,
we only extract the chipset platforms (e.g., Snapdragon 8XX)
from this bulletin. Unfortunately, it is not possible for us to map
the chipset names released in MediaTek security bulletin&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xmediatek-december">10</a>]</span>
with the <span 
class="ptmri8t-">Dimensity XXXX </span>chipset platform. Therefore, we only
search for MediaTek-based phones employing the exact chipset
names used in our evaluation (<span 
class="ptmri8t-">Dimensity 900/1200</span>) to avoid false
positives. Consequently, our computed set of smartphone models,
which are affected by MediaTek modem vulnerabilities, is an
underestimation.
</p><!--l. 542--><p class="indent" >  Once we have all the chipset names listed, we use a scraping
script to automate the search for all smartphone models
employing the affected chipsets. Since many results presented in
Kimovil web page are duplicated, we filter out smartphone
entries that contain duplicated names, but variate only slightly in
their specification (e.g., RAM and storage size). The summarized
number of affected smartphones models across the market is
shown via the pie chart of Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-11001r8">8<!--tex4ht:ref: fig:5ghoul-affected-phones --></a>. Notably, while most of the
smartphone models e.g., <span id="textcolor40"><span 
class="ptmbi8t-">Samsung, OnePlus, Oppo, Vivo,</span>
<span 
class="ptmbi8t-">Xiaomi etc.</span></span> in our estimation use chipsets from Qualcomm (670
out of 714 i.e., <span 
class="ptmb8t-">94%</span>), we were only able to match a few phones
using MediaTek&#8217;s <span 
class="ptmri8t-">Dimensity 900 </span>and <span 
class="ptmri8t-">Dimensity 1200</span>. As
discussed in the preceding paragraph, the set of MediaTek-based affected smartphones is quite an under-approximation due to the
  limited search. The detailed list of smartphone models is found in
  the following URL: <a 
target="_blank" href="https://asset-group.github.io/disclosures/5ghoul/5ghoul_affected_chipset_phones.pdf" ><span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;affected smartphones</a>. We also
  checked whether these phones use at least one 5G band for the
  attacks to be feasible to launch. We found over <a 
target="_blank" href="https://asset-group.github.io/disclosures/5ghoul/filtered_5g_phones.txt" >626 phones
  amongst</a> the listed smartphones in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-11001r8">8<!--tex4ht:ref: fig:5ghoul-affected-phones --></a> to support 5G
  band.
  </p>
    <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-11001r8"></a>
                                                
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 568--><p class="noindent" >
</p><!--l. 569--><p class="noindent" > <img 
src="figures/pie_chart_5Ghoul.pdf.svg" alt="PIC"  
width="600" height="auto"  /><br /></p><div class="caption" 
><span class="id">Figure&#x00A0;8:  </span><span  
class="content">Distribution  of  smartphone  models  potentially
affected by <span 
class="ptmri8t-">5Ghoul</span>. Data based on Qualcomm and MediaTek
security   disclosures&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xqualcomm-december">13</a>,&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xmediatek-december">10</a>]</span>   and   Kimovil   smartphone
listings.</span></div><!--tex4ht:label?: x1-11001r8 -->
</div>
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 588--><p class="indent" >  Finally, it is worthwhile to mention that the reach of
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities goes beyond smartphones. This is
because the affected 5G modems are also used in other
5G-enabled applications. Indeed, as detailed in Qualcomm
Security Bulletin&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#Xqualcomm-december">13</a>]</span>, <span id="textcolor41"><span 
class="ptmbi8t-">5Ghoul</span><span 
class="ptmbi8t-">&#x00A0;</span><span 
class="ptmbi8t-">&#x00A0;vulnerabilities potentially</span>
<span 
class="ptmbi8t-">affect Industrial IoT solutions such as &#8220;315 5G IoT" as well as</span>
<span 
class="ptmbi8t-">other platforms e.g., &#8220;</span><span 
class="ptmb8t-">AR8035</span><span 
class="ptmbi8t-">" used in diverse applications</span>
<span 
class="ptmbi8t-">including home appliances, IP Cameras etc.</span></span>
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">4.5    </span> <a 
 id="x1-120004.5"></a>The Challenge of Delivering 5G Patches to the
End-user</h4>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                
                                                                                                
                                                                                                
<a 
 id="x1-12001r9"></a>
                                                
                                                                                                
                                                                                                
<!--l. 8--><p class="noindent" > <img 
src="figures/5g-ecosystem.pdf.svg" alt="PIC"  
width="450" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;9: </span><span  
class="content">5G UE Software Supply Ecosystem</span></div><!--tex4ht:label?: x1-12001r9 -->
                                                
                                                                                                
                                                                                                
  </div></div>
<!--l. 13--><p class="indent" >  It is critical to ensure that the modem software development
kit (SDK) is well tested and devoid of serious vulnerabilities
before being released downstream. Otherwise, attackers
may exploit a modem failure for a prolonged period and
before the end user can actually pull the relevant security
updates.
</p><!--l. 19--><p class="indent" >  Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r9">9<!--tex4ht:ref: fig:5g-ecosystem --></a> depicts the complexity of the software supply
chain of a 5G modem. In summary, finding issues in the
implementation of the 5G modem vendor heavily impacts
product vendors downstream. This is because the software
dependency of product vendors on the <span 
class="ptmri8t-">Modem / Chipset</span>
<span 
class="ptmri8t-">Vendor </span>adds complexity and hence delays to the process of
producing and distributing patches to the end-user. For example,
each iteration that the upstream 5G modem software goes
through, carrier recertification must be performed by the
chipset vendor so that the updated modem firmware can
be integrated into OS security patches by the smartphone
OS vendor on a fixed release schedule (i.e., Google for
Android and Apple for IOS). Next, such security patches
ought to be manually built into the smartphone OS image
by the <span 
class="ptmri8t-">product vendor</span>. Therefore, it can often take six or
more months for 5G security patches to finally reach the
end-user via an OTA update (final downstream node in
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r9">9<!--tex4ht:ref: fig:5g-ecosystem --></a>).
</p><!--l. 34--><p class="indent" >  The chain of software dependencies are similarly applied to
CPE routers or USB Modems. However, such type of products
have a shorter time to distribute patches to the end-user since
adhering to the release schedule of OS vendors is not required.
Instead, the module vendor (i.e., OEM of Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r9">9<!--tex4ht:ref: fig:5g-ecosystem --></a>) directly
builds modem patches into the module firmware and distribute it
downstream via private channels. Therefore, the CPE product
vendor can directly apply the patches from upstream to its
platform software, which usually includes a customized Linux
OS.
</p>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">5    </span> <a 
 id="x1-130005"></a><a id="poc-tool">Fuzzing Tool and Exploit Scripts</a></h3>
<!--l. 6--><p class="noindent" >The <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;proof-of-concept (PoC) and fuzzing tool is
available open-source at our github repository:
</p>
<div class="center" 
>
<!--l. 9--><p class="noindent" >
</p><!--l. 10--><p class="noindent" ><a 
target="_blank" href="https://github.com/asset-group/5ghoul-5g-nr-attacks#5ghoul---5g-nr-attacks--5g-ota-fuzzing" >https://github.com/asset-group/5ghoul-5g-nr-attacks</a></p></div>
<!--l. 13--><p class="indent" >  <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;PoC is built on top of an over-the-air fuzzing
framework that provides 5G NR protocol control to create test
cases targeting 5G-capable Android smartphones or Qualcomm
USB based modems. Nevertheless, using <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;involves a
software defined radio such as USRP B210 to bring up the        physical rogue base station. Once the <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;PoC is started, it
     automates the configuration process of the smartphone or modem
     to connect to the rogue base station for evaluating the attacks.
     Such PoC can also be used as a standalone over-the-air 5G SA
     fuzzer.
     </p><!--l. 22--><p class="indent" >    Our existing setup is quite portable when paired with an
     inexpensive mini PC (<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;Mini PC in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-13001r10">10<!--tex4ht:ref: fig:physical-setup --></a>).
     Currently, <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;PoC contains exploit scripts to launch
     attacks exploiting <span 
class="ptmbi8t-">V3-V14 </span>(see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). Scripts for other attacks
     exploiting <span 
class="ptmbi8t-">V1-2 </span>and <span 
class="ptmbi8t-">NAS Flooding Downgrade </span>(see Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-10001r7">7<!--tex4ht:ref: fig:downgrade-2 --></a>)
     will be made available in the upcoming weeks.
     </p>
         <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-13001r10"></a>
                                                
                                                                                                
                                                                                                
<!--l. 31--><p class="noindent" > <img 
src="figures/physical_setup.pdf.svg" alt="PIC"  
width="600" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;10: </span><span  
class="content">Hardware Setup for <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;PoC testing and
fuzzer evaluation.</span></div><!--tex4ht:label?: x1-13001r10 -->
                                                
                                                                                                
                                                                                                
  </div></div>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">6    </span> <a 
 id="x1-140006"></a>Reflection</h3>
<!--l. 4--><p class="noindent" >In this section, we outline some of the key challenges we faced
over the past few years, especially along the line of automated
security testing of COTS 5G devices. We also discuss our
personal experiences during the disclosure process that sheds
light on the downstream patch propagation complexity and
timeline.
</p><!--l. 9--><p class="noindent" ><span 
class="ptmb8t-">Identification of Crashes: </span>As our focus is on testing COTS
devices, we faced significant challenges in precisely identifying
device crashes. In particular, due to the nature of our adversarial
testing (e.g., communicating malformed packets), the targeted
5G UEs may face arbitrary connection timeouts. Such
connection-timeouts are normal and should not be confused with
crashes (i.e., denial of service). Our initial research involved
going through many message logs and trying to identify
messages that may reliably indicate a crash. Indeed, at the early
stage of our research, we had several message logs suspected to
have crashes and only to be ruled out later as normal connection
timeouts.
</p><!--l. 24--><p class="indent" >  In particular, 5G USB modems contain a combination of
proprietary and common AT commands for their configuration,
which respond differently depending on the vendor&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XkarimOpeningPandoraBox2019">7</a>]</span>. To
solve the crash detection problem in a generic fashion for 5G
USB modems, we hand over control of the UE modem to
Freedesktop ModemManager process (MM)&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XMM">4</a>]</span>. MM process
communicates with the UE mostly via the standard Qualcomm
MSM Interface (QMI) and falls back to AT when necessary. In
particular, whenever the modem is configured and ready to be
used, MM informs our test process. Moreover, MM alerts modem
crashes by informing QMI interface hangs or USB detachment
caused by modem software reset. As per 5G smartphones, the
device crash is indicated in the message log. Nonetheless, such a
message varies with respect to modem vendor (e.g., Qualcomm,
Mediatek etc.). Thus, the detection of 5G modem crashes in
smartphones still involves minor vendor-specific engineering
effort.
</p><!--l. 40--><p class="noindent" ><span 
class="ptmb8t-">Debugging Support for Triage: </span>Due to the closed nature of 5G
UE stack, there is little support for us to triage crashes. This
holds even after we confirm and report the vulnerability to
vendor. While the message logs and Wireshark capture can show
the modified packet(s) and crash indication, it still requires
significant effort to locate the crash at the firmware code. During
our disclosure period, one of the vendors (<span 
class="ptmri8t-">Telit</span>) helped to provide
better logging tool for debugging. Specifically, such a tool
generated a comprehensive HTML report containing both
core dump and backtrace summary, including several other
information needed for Qualcomm&#8217;s action. In particular, such a
report could be generated for Qualcomm for vulnerabilities
<span 
class="ptmb8t-">V5 </span>and <span 
class="ptmb8t-">V6 </span>(see Section&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-150007">7<!--tex4ht:ref: sec:5g-vulnerabilities --></a>), both of which led to firmware
crashes (reachable assert). However, this was not the case for       vulnerability <span 
class="ptmb8t-">V7 </span>that leads to a <span 
class="ptmri8t-">hang</span>. Thus, no backtrace
     report could be produced to accelerate the triage effort for
     <span 
class="ptmb8t-">V7</span>.
     </p><!--l. 54--><p class="noindent" ><span 
class="ptmb8t-">Time to Patch Downstream: </span>In Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r9">9<!--tex4ht:ref: fig:5g-ecosystem --></a>, we have illustrated
     the typical 5G UE software supply chain. In line with the
     ecosystem shown in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-12001r9">9<!--tex4ht:ref: fig:5g-ecosystem --></a>, we share our experience with the
     time involved in 5G modem patches becoming available to end
     users (e.g., smartphone users). We reported first vulnerabilities
     (i.e., <span 
class="ptmb8t-">V5 </span>and <span 
class="ptmb8t-">V6 </span>in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>) to Telit (USB modem vendor) on
     <span 
class="ptmri8t-">17th April 2023</span>. Telit kindly provided a logging tool, which, in
     turn generated a comprehensive HTML report containing
     both core dump and backtrace summary. Such a summary
     clearly showed that the root cause of the crash/vulnerability
     resides in Qualcomm firmware code, seizing possibility of
     patches to be produced by Telit. This also confirmed that other
     products (e.g., smartphones) using the same Qualcomm 5G
     modems would also be affected in a similar fashion. After
     sending the comprehensive report to Qualcomm on <span 
class="ptmri8t-">21st April</span>
     <span 
class="ptmri8t-">2023</span>, the crash triage was completed on <span 
class="ptmri8t-">9th May 2023</span>.
     Eventually the patch for these vulnerabilities were provided
     by Qualcomm internally to their clients on <span 
class="ptmri8t-">August 2023</span>.
     Finally, Android patches are expected to be available on
     <span 
class="ptmri8t-">December 2023 </span>for (smartphone) end users to repair our reported
     vulnerabilities.
     </p><!--l. 73--><p class="indent" >    <span id="textcolor42"><span 
class="ptmbi8t-">In summary, it took approximately seven (7) months for the</span>
     <span 
class="ptmbi8t-">patch to be available to end users since it was reproduced by the</span>
     <span 
class="ptmbi8t-">vendor and approximately eight (8) months since its discovery.</span></span>
     This shows the complexity of patch propagation to end users
     in 5G UE software supply chain. For vulnerabilities that
     did not have any accompanied crash report e.g., <span 
class="ptmb8t-">V7 </span>(see
     Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-18001r13">13<!--tex4ht:ref: fig:v7 --></a>), it took slightly longer time to triage (as expected
     due to the absence of any crash report): we reported on
     <span 
class="ptmri8t-">11th May 2023 </span>and the triage was complete on <span 
class="ptmri8t-">13th June</span>
     <span 
class="ptmri8t-">2023</span>.
     </p><!--l. 80--><p class="noindent" ><span 
class="ptmb8t-">Software/Hardware Support for Testing at Scale: </span>Our
     approach involves sending malformed packets from a malicious
     base station to COTS 5G UE. Such also needs to be done
     arbitrarily many times and automatically to uncover deeply
     rooted vulnerabilities in modem firmware. At an early stage of
     our research, we faced significant technical challenges to simply
     keep a stable over-the-air connection between open-source base
     station (i.e., OpenAirInterface&#x00A0;<span class="cite">&#x00A0;[<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#XnikaeinOpenAirInterfaceFlexiblePlatform2014">11</a>]</span>) and COTS 5G UE (e.g.,
     commercial smartphones). This, in turn, resulted significant
     roadblocks in achieving practical results via over-the-air fuzzing.
     Moreover, due to the nature of fuzzing, we discovered that USB
     5G modems frequently becomes unstable, which, in turn makes
     the fuzzing difficult to progress. To address this, we added a USB
     power switch to automatically restart USB modems. For Android
     smartphones, similar restart mechanism can be achieved via
     sending <span 
class="ptmri8t-">reboot </span>command through Android Debug Bridge
     (ADB).
     </p><!--l. 94--><p class="indent" >    While 5G comes with a lot of potential for supporting
     complex applications, we foresee the need for deeper
     research in automatically and comprehensively hunting for
                                                                                                
                                                                                                
implementation-level vulnerabilities in 5G software systems.
Considering the multi-layer, complex implementation of
5G network stack and its closed nature, the research in
5G security testing has a long way ahead. This is evident
from the discovery of <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities in major
chipset vendors, who, despite having all the resources for
comprehensively testing their own 5G stack, are still susceptible
to <span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;vulnerabilities.
</p><!--l. 1--><p class="noindent" >
</p>
  <h3 class="sectionHead" style="font-size: 2rem;"><span class="titlemark">7    </span> <a 
 id="x1-150007"></a><a id="technical-description">Vulnerabilities Description</a></h3>
<!--l. 4--><p class="noindent" >In this section, we provide a detailed description of each
vulnerability, attack vector, the affected 5G modem chipsets
and/or the firmware version where applicable. We only include
implementation vulnerabilities that were unknown at the time of
discovery (i.e., <span 
class="ptmb8t-">V5</span>-<span 
class="ptmb8t-">V14 </span>in Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). Some vulnerabilities were
discovered when testing modems while others were detected by
testing smartphones.
                                                
                                                                                                
                                                                                                
                                                
                                                                                                
                                                                                                
</p>
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.1    </span> <a 
 id="x1-160007.1"></a>V5: Invalid MAC/RLC PDU<br 
class="newline" />(CVE-2023-33043)</h4>
<!--l. 17--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the <span id="textcolor43"><span 
class="ptmbi8t-">Qualcomm&#8217;s X55/X60</span></span> modem firmware by
means of sending invalid downlink MAC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB. After the <span 
class="ptmri8t-">RRC</span>
<span 
class="ptmri8t-">Attach Procedure </span>is complete, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RLC Status PDU</span>, changing the MAC header (first byte)
of the downlink transport block from 0x41 (DL-SCH) to <span id="textcolor44"><span 
class="ptmbi8t-">0xB5 (MAC TCI States Activation/Deactivation)</span></span>. We highlight this
byte in red in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-16001r11">11<!--tex4ht:ref: fig:v5 --></a>. After the invalid frame is sent to the 5G UE, the Qualcomm X55 modem fails and reboots,
indicating a firmware assert in the coredump log (QCAP). More specifically, the modem temporarily hangs and performs
a reboot in <span 
class="ptmbi8t-">5 to 10 seconds</span>. This delay is noticeable in products using such modems. For example, <span 
class="ptmri8t-">Telit FT980-WW</span>
&#x00A0;Web-based application becomes accessible only after the platform reboots due to the following firmware coredump
message:
</p><!--l. 49--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] nr5g_ml1_mdb.c:12636 Assert serving_cell_ptr-&#x003E;cell_data.nr5g.configured_bwp_bmask &amp;
(1&#x003C;&#x00A0;&#x003C;bwp_idx) failed: gNB beam update for BWP not configured 0x1 </q-banner>
</p><!--l. 51--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">An attacker within X55/X60 modem-based UE radio range can block 3GPP Modem connectivity by continuously sending an</span>
<span 
class="ptmri8t-">invalid packet</span>. Furthermore, this vulnerability is fairly easy to trigger since no information about the target&#8217;s SIM card information is
required to launch the attack. This is because the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before
any NAS authentication procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-16001r11"></a>
                                                                                                
                                                                                                
<!--l. 78--><p class="noindent" > <img 
src="figures/attack-v5.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;11: </span><span  
class="content">Invalid MAC/RLC PDU.</span></div><!--tex4ht:label?: x1-16001r11 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.2    </span> <a 
 id="x1-170007.2"></a>V6: NAS Unknown PDU<br 
class="newline" />(CVE-2023-33044)</h4>
<!--l. 85--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the <span id="textcolor45"><span 
class="ptmbi8t-">Qualcomm&#8217;s X55/X60</span></span> modem firmware by
means of sending invalid downlink MAC frame to the target 5G UE (smartphone, CPE router) from a nearby malicious gNB. After the
<span 
class="ptmri8t-">RRC Attach Procedure </span>is complete and before NAS network registration is complete, the attacker (malicious gNB) sends an invalid NAS
PDU, changing the third byte of the <span 
class="ptmbi8t-">RRC dlInformationTransfer </span>from <span 
class="ptmri8t-">0xC0 </span>(NAS Authentication Request) to <span id="textcolor46"><span 
class="ptmbi8t-">0xF4 (NAS Unknown</span>
<span 
class="ptmbi8t-">PDU)</span></span> (See this byte highlighted in red in the Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-17001r12">12<!--tex4ht:ref: fig:v6 --></a>). After the invalid frame is sent to the 5G UE, the Qualcomm X55/X60 modem
fails and reboots, indicating a firmware assert in the coredump log (QCAP). More specifically, the modem temporarily
hangs and performs a reboot in <span 
class="ptmbi8t-">5 to 10 seconds</span>. This delay is noticeable in applications. For example, <span 
class="ptmri8t-">Telit FT980-WW</span>
&#x00A0;Web-based application becomes accessible only after the platform reboots due to the following firmware coredump
message:
</p><!--l. 114--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] ds_3gpp_tlb_ctrl.c:2088 Assertion msg_size == 1 failed </q-banner>
</p><!--l. 116--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">An attacker within X55/X60 UE radio range can block 3GPP Modem connectivity by continuously sending an invalid packet</span>.
Furthermore, this vulnerability is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch
the attack. This is because the invalid downlink frame is sent <span 
class="ptmri8t-">early </span>in the NAS registration procedure, which happens before any NAS
authentication procedure completes.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-17001r12"></a>
                                                                                                
                                                                                                
<!--l. 127--><p class="noindent" > <img 
src="figures/attack-v6.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;12: </span><span  
class="content">NAS Unknown PDU.</span></div><!--tex4ht:label?: x1-17001r12 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.3    </span> <a 
 id="x1-180007.3"></a>V7: Disabling 5G / Downgrade via Invalid RRC pdcch-Config<br 
class="newline" />(CVE-2023-33042)</h4>
<!--l. 138--><p class="noindent" >An attacker within radio range can trigger a 5G connectivity downgrade or denial of service within the <span id="textcolor47"><span 
class="ptmbi8t-">Qualcomm&#8217;s X55/X60</span></span> modem
firmware by means of sending malformed RRC frame to the target 5G UE (smartphone, CPE router) from a nearby malicious gNB.
During the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed NAS PDU, changing the <span 
class="ptmri8t-">30th </span>byte of the <span 
class="ptmbi8t-">RRC</span>
<span 
class="ptmbi8t-">dlInformationTransfer </span>payload from <span 
class="ptmri8t-">0x04 </span>to <span id="textcolor48"><span 
class="ptmbi8t-">0x9C</span></span>. This modifies optional bits of the <span 
class="ptmbi8t-">pdcch-Config </span>such as <span id="textcolor49"><span 
class="ptmbi8t-">tpc-PUCCH</span></span> and
<span id="textcolor50"><span 
class="ptmbi8t-">Sequence-Of Length</span></span> (See these bytes highlighted in red in the Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-17001r12">12<!--tex4ht:ref: fig:v6 --></a>). After the malformed message is sent to the 5G UE,
connection to any 5G network fails. For example, USB Modems or CPE Routers are often not able to scan 5G networks via the serial
command <span 
class="ptmri8t-">AT+COPS=? </span>and hence connection to any gNB (including legitimate ones) fails. Moreover, attempting to connect to
any listed 5G network does not succeed either. This behavior was verified to occur in all of our 5G-capable Qualcomm
devices such as <span 
class="ptmri8t-">Asus Rog Phone 5S</span>, <span 
class="ptmri8t-">Quectel RM500Q-GL </span>etc (see Table&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-6002r2">2<!--tex4ht:ref: tab:summary --></a>). Once the attack is launched, the X55/X60
modem remains affected until the user reboots the phone. Simply switching airplane mode on and off does not restore 5G
communication.
</p><!--l. 159--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">An attacker within Qualcomm X55/X60 UE radio range can deny or downgrade 5G connectivity by sending a single</span>
<span 
class="ptmri8t-">malformed packet. The user needs to manually reboot the phone to recover 5G connectivity</span>. Furthermore, this vulnerability is fairly easy
to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-18001r13"></a>
                                                                                                
                                                                                                
<!--l. 171--><p class="noindent" > <img 
src="figures/attack-v7.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;13: </span><span  
class="content">Disabling 5G / Downgrade via Invalid RRC pdcch-Config.</span></div><!--tex4ht:label?: x1-18001r13 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.4    </span> <a 
 id="x1-190007.4"></a>V8: Invalid RRC Setup spCellConfig<br 
class="newline" />(CVE-2023-32842)</h4>
<!--l. 184--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor51"><span 
class="ptmbi8t-">Dimensity 900 /</span>
<span 
class="ptmbi8t-">1200</span></span> 5G modem firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone)
from a nearby malicious gNB. During the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed
<span 
class="ptmri8t-">RRC Connection Setup</span>, changing the <span 
class="ptmri8t-">35th </span>byte of the downlink transport block from <span 
class="ptmri8t-">0x4C </span>to <span 
class="ptmri8t-">0xD6 </span>and <span 
class="ptmri8t-">66th </span>byte from
<span 
class="ptmri8t-">0x9A </span>to <span 
class="ptmri8t-">0x71 </span>(See this bytes highlighted in red in the Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-19001r14">14<!--tex4ht:ref: fig:v8 --></a>). This corresponds to changing some fields within the
RRC payload such <span 
class="ptmri8t-">spCellConfigDedicated </span>optional bits: <span 
class="ptmbi8t-">defaultDownlinkBWP-Id=</span><span id="textcolor52"><span 
class="ptmbi8t-">1</span></span>, <span 
class="ptmbi8t-">pdcch-ServingCellConfig=</span><span id="textcolor53"><span 
class="ptmbi8t-">1</span></span>,
<span 
class="ptmbi8t-">pdsch-ServingCellConfig=</span><span id="textcolor54"><span 
class="ptmbi8t-">0</span></span>, <span 
class="ptmbi8t-">sCellDeactivationTimer=</span><span id="textcolor55"><span 
class="ptmbi8t-">1</span></span>. After such an invalid packet is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G
modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 219--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:mcu/l1/mml1/mml1_endc/src/mml1_endc_db_hdlr.c line:524 p1:0x91920c70 </q-banner>
</p><!--l. 221--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-19001r14"></a>
                                                                                                
                                                                                                
<!--l. 247--><p class="noindent" > <img 
src="figures/attack-v8.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;14: </span><span  
class="content">Invalid RRC Setup spCellConfig.</span></div><!--tex4ht:label?: x1-19001r14 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.5    </span> <a 
 id="x1-200007.5"></a>V9: Invalid RRC pucch CSIReportConfig<br 
class="newline" />(CVE-2023-32844)</h4>
<!--l. 253--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor56"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G modem
firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB. During
the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection Setup</span>, changing the <span 
class="ptmbi8t-">192nd byte </span>of the
downlink transport block from <span 
class="ptmri8t-">0x0A </span>to <span id="textcolor57"><span 
class="ptmbi8t-">0xD0</span></span> (See this byte highlighted in red in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-20001r15">15<!--tex4ht:ref: fig:v9 --></a>). This corresponds to changing some fields
within the RRC payload (<span 
class="ptmri8t-">searchSpacesToAddModList </span>element) such as <span 
class="ptmbi8t-">pucch-Resource </span>from <span 
class="ptmri8t-">0x02 </span>to <span id="textcolor58"><span 
class="ptmbi8t-">0x52</span></span> and <span 
class="ptmbi8t-">reportQuantity</span>
from <span 
class="ptmri8t-">0x05 (cri-RSRP) </span>to <span id="textcolor59"><span 
class="ptmbi8t-">0x01 (cri-RI-PMI-CQI)</span></span>. After such invalid packet is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G
modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 285--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:mcu/l1/nl1/internal/md97/src/rx/nr_rx_dspcmd_ext_csif_csi.c line:2657 p1:0x00000000
</q-banner>
</p><!--l. 288--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-20001r15"></a>
                                                                                                
                                                                                                
<!--l. 314--><p class="noindent" > <img 
src="figures/attack-v9.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;15: </span><span  
class="content">Invalid RRC pucch CSIReportConfig.</span></div><!--tex4ht:label?: x1-20001r15 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.6    </span> <a 
 id="x1-210007.6"></a>V10: Invalid RLC Data Sequence<br 
class="newline" />(CVE-2023-20702)</h4>
<!--l. 319--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">null pointer dereference</span>) within the Mediatek <span id="textcolor60"><span 
class="ptmbi8t-">Dimensity 900 /</span>
<span 
class="ptmbi8t-">1200</span></span> 5G modem firmware by means of sending invalid downlink RLC payload to the target 5G UE (e.g., smartphone)
from a nearby malicious gNB. After the <span 
class="ptmri8t-">RRC attach procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RLC</span>
<span 
class="ptmri8t-">Status PDU</span>, changing the <span 
class="ptmbi8t-">4th </span>byte of the downlink transport block from 0x00 to <span id="textcolor61"><span 
class="ptmbi8t-">0x84</span></span> (See this byte highlighted in red
in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-21001r16">16<!--tex4ht:ref: fig:v10 --></a>). This corresponds to changing some fields within the RLC header such as <span 
class="ptmbi8t-">Data/Control field </span>to <span id="textcolor62"><span 
class="ptmbi8t-">0x01</span>
<span 
class="ptmbi8t-">(Data PDU)</span></span> and <span 
class="ptmbi8t-">RLC Sequence Number </span>to <span id="textcolor63"><span 
class="ptmbi8t-">1025</span></span>. The original downlink packet is an <span 
class="ptmri8t-">RLC Control PDU (Status ACK)</span>.
However, after writing the invalid byte <span id="textcolor64"><span 
class="ptmbi8t-">0x84</span></span> to the RLC Header, such PDU is changed to a <span 
class="ptmri8t-">Data PDU </span>with a wrong
(out-of-order) RLC Data sequence number. After the invalid RLC payload is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G
modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 353--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [Fatal error(MPU_NOT_ALLOW)] err_code1:0x0000001D err_code2:0x910D66F6 err_code3:0x910D66E2
</q-banner>
</p><!--l. 355--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is
because the invalid downlink frame is sent <span 
class="ptmri8t-">after </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-21001r16"></a>
                                                                                                
                                                                                                
<!--l. 381--><p class="noindent" > <img 
src="figures/attack-v10.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;16: </span><span  
class="content">Invalid RLC Data Sequence.</span></div><!--tex4ht:label?: x1-21001r16 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.7    </span> <a 
 id="x1-220007.7"></a>V11: Truncated RRC physicalCellGroupConfig<br 
class="newline" />(CVE-2023-32846)</h4>
<!--l. 390--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">null pointer dereference</span>) within the Mediatek <span id="textcolor65"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G
modem firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB.
During the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection Setup</span>, changing the <span 
class="ptmbi8t-">14th </span>and <span 
class="ptmbi8t-">15th</span>
bytes of the downlink transport block from <span 
class="ptmri8t-">0xBA 0xE0 </span>to <span id="textcolor66"><span 
class="ptmbi8t-">0x13 0x46</span></span> (See these bytes highlighted in red in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-22001r17">17<!--tex4ht:ref: fig:v11 --></a>). This corresponds
to changing some fields within the <span 
class="ptmbi8t-">physicalCellGroupConfig </span>such as <span id="textcolor67"><span 
class="ptmbi8t-">Extension bit</span></span> to <span id="textcolor68"><span 
class="ptmbi8t-">0x01 (True)</span></span> and <span id="textcolor69"><span 
class="ptmbi8t-">pdsch-HARQ-ACK-Codebook</span></span> to
<span id="textcolor70"><span 
class="ptmbi8t-">0x00 (semiStatic)</span></span>. Consequently, this causes the RRC message to be truncated, thus causing encoding errors as highlighted in Wireshark
(yellow messages in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-22001r17">17<!--tex4ht:ref: fig:v11 --></a>). After such malformed packet is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G modem fails
and reboots, indicating a firmware memory access error in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 423--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [Fatal error(MPU_NOT_ALLOW)] err_code1:0x0000001D err_code2:0x90F5D83A err_code3:0x90F5D836
</q-banner>
</p><!--l. 425--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such malformed packet</span>. Furthermore, this
vulnerability is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is
because the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-22001r17"></a>
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 434--><p class="noindent" >
</p><!--l. 436--><p class="noindent" > <img 
src="figures/attack-v11.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;17: </span><span  
class="content">Truncated RRC physicalCellGroupConfig.</span></div><!--tex4ht:label?: x1-22001r17 -->
</div>
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.8    </span> <a 
 id="x1-230007.8"></a>V12: Invalid RRC searchSpacesToAddModList<br 
class="newline" />(CVE-2023-32841)</h4>
<!--l. 450--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor71"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G
modem firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby
malicious gNB. During the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection</span>
<span 
class="ptmri8t-">Setup</span>, changing the <span 
class="ptmbi8t-">52nd byte </span>of the downlink transport block from <span 
class="ptmri8t-">0x00 </span>to <span id="textcolor72"><span 
class="ptmbi8t-">0x5B</span></span> (See this byte highlighted in red in
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-23001r18">18<!--tex4ht:ref: fig:v12 --></a>). This corresponds to changing some fields within the RRC payload (<span 
class="ptmri8t-">searchSpacesToAddModList element</span>) such as
<span 
class="ptmbi8t-">monitoringSymbolsWithinSlots </span>from <span 
class="ptmri8t-">0x80 0x00 </span>to <span id="textcolor73"><span 
class="ptmbi8t-">0x82 0xd8</span></span>. After such invalid packet is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G
modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 480--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:dsp3/coresonic/msonic/modem/slm/nr/nr_post_proc/src/nr_slm_rpt_hndlr.c line:9302
</q-banner>
</p><!--l. 482--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-23001r18"></a>
                                                                                                
                                                                                                
<!--l. 493--><p class="noindent" > <img 
src="figures/attack-v12.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;18: </span><span  
class="content">Invalid RRC searchSpacesToAddModList.</span></div><!--tex4ht:label?: x1-23001r18 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.9    </span> <a 
 id="x1-240007.9"></a>V13: Invalid RRC Uplink Config Element<br 
class="newline" />(CVE-2023-32843)</h4>
<!--l. 503--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor74"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G modem
firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB. During
the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection Setup</span>, changing the <span 
class="ptmbi8t-">92nd byte </span>of the
downlink transport block from <span 
class="ptmri8t-">0x49 </span>to <span id="textcolor75"><span 
class="ptmbi8t-">0x67</span></span> (See this byte highlighted in red in the Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-24001r19">19<!--tex4ht:ref: fig:v13 --></a>). This corresponds to changing many fields
within the RRC payload such as <span id="textcolor76"><span 
class="ptmbi8t-">qcl-Type</span></span> from 0x02 to <span id="textcolor77"><span 
class="ptmbi8t-">0x03</span></span>, <span id="textcolor78"><span 
class="ptmbi8t-">resourceAllocation</span></span> from 0x01 to <span id="textcolor79"><span 
class="ptmbi8t-">0x00</span></span>, <span id="textcolor80"><span 
class="ptmbi8t-">rbg-size</span></span> from 0x00 to <span id="textcolor81"><span 
class="ptmbi8t-">0x01</span></span>,
<span id="textcolor82"><span 
class="ptmbi8t-">prb-BundlingType</span></span> from 0x00 to <span id="textcolor83"><span 
class="ptmbi8t-">0x01</span></span> and other <span 
class="ptmbi8t-">uplinkConfig optional bits</span>. After such invalid packet is sent to the 5G UE, the
<span 
class="ptmri8t-">Dimensity 900 </span>5G modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 535--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:mcu/l1/nl1/internal/md97/src/rfd/nr_rfd_configdatabase.c line:4380 p1:0x00000001
</q-banner>
</p><!--l. 537--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-24001r19"></a>
                                                                                                
                                                                                                
<!--l. 548--><p class="noindent" > <img 
src="figures/attack-v13.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;19: </span><span  
class="content">Invalid RRC Uplink Config Element.</span></div><!--tex4ht:label?: x1-24001r19 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.10    </span> <a 
 id="x1-250007.10"></a>V14: Null RRC Uplink Config Element<br 
class="newline" />(CVE-2023-32845)</h4>
<!--l. 559--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor84"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G modem
firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB.
During the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection Setup</span>, changing
the <span 
class="ptmbi8t-">50th byte </span>of the downlink transport block from <span 
class="ptmri8t-">0xA2 </span>to <span id="textcolor85"><span 
class="ptmbi8t-">0xA1</span></span> (See this byte highlighted in red in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-25001r20">20<!--tex4ht:ref: fig:v14 --></a>). This
corresponds to changing some fields within the RRC payload such as <span id="textcolor86"><span 
class="ptmbi8t-">controlResourceSetId</span></span> to <span id="textcolor87"><span 
class="ptmbi8t-">0x00</span></span>, <span id="textcolor88"><span 
class="ptmbi8t-">pdsch-Config</span></span> to <span id="textcolor89"><span 
class="ptmbi8t-">0x00</span>
<span 
class="ptmbi8t-">(release)</span></span>, amongst other fields as shown in Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-25001r20">20<!--tex4ht:ref: fig:v14 --></a>. Particularly, when <span 
class="ptmri8t-">pdsch-Config </span>is set to release, the <span 
class="ptmri8t-">Uplink Config</span>
<span 
class="ptmri8t-">Element </span>is decoded as <span 
class="ptmri8t-">Null</span>. Consequently, when such an invalid packet is sent to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G
modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the modem
temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 591--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:dsp3/coresonic/msonic/modem/brp/nr/nr_brp/src/nr_brp_top_irq.c line:927 </q-banner>
</p><!--l. 593--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such invalid packet</span>. Furthermore, this vulnerability
is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is because
the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-25001r20"></a>
                                                                                                
                                                                                                
<!--l. 604--><p class="noindent" > <img 
src="figures/attack-v14.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;20: </span><span  
class="content">Null RRC Uplink Config Element.</span></div><!--tex4ht:label?: x1-25001r20 -->
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.11    </span> <a 
 id="x1-260007.11"></a>V15: Invalid RRC CellGroup ID<br 
class="newline" />(CVE-2024-20003)</h4>
<!--l. 614--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor90"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G modem
firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB. During
the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends a malformed <span 
class="ptmri8t-">RRC Connection Setup</span>, changing the <span 
class="ptmbi8t-">15th byte </span>of the
downlink transport block from <span 
class="ptmri8t-">0xE0 </span>to <span id="textcolor91"><span 
class="ptmbi8t-">0xE4</span></span> (See this byte highlighted in red in the Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-26001r21">21<!--tex4ht:ref: fig:v15 --></a>). This corresponds to changing some
fields within the RRC payload (<span 
class="ptmri8t-">CellGroupId element</span>) such as <span 
class="ptmbi8t-">cellGroupId </span>from <span 
class="ptmri8t-">0x00 </span>to <span id="textcolor92"><span 
class="ptmbi8t-">0x02</span></span>. After such invalid packet is sent to the 5G
UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G modem fails and reboots, indicating a firmware crash/assert in the Android logs (logcat). More specifically, the
modem temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>, being noticeable by logcat outputting the following firmware assert
message:
</p><!--l. 645--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [ASSERT] file:mcu/l1/nl1/internal/md97/src/ctrl/nr_ctrl_mgm.c line:16460 </q-banner>
</p><!--l. 647--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such malformed packet</span>. Furthermore, this
vulnerability is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is
because the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-26001r21"></a>
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 656--><p class="noindent" >
</p><!--l. 658--><p class="noindent" > <img 
src="figures/attack-V15.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;21: </span><span  
class="content">Invalid RRC CellGroup ID.</span></div><!--tex4ht:label?: x1-26001r21 -->
</div>
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h4 class="subsectionHead" style="font-size: 1rem;font-weight:bold;line-height: 1.5rem;"><span class="titlemark">7.12    </span> <a 
 id="x1-270007.12"></a>V16: Invalid RRC CellGroupConfig <br 
class="newline" />(CVE-2024-20004)</h4>
<!--l. 667--><p class="noindent" >An attacker within radio range can trigger a denial of service (<span 
class="ptmbi8t-">reachable assert</span>) within the Mediatek <span id="textcolor93"><span 
class="ptmbi8t-">Dimensity 900 / 1200</span></span> 5G modem
firmware by means of sending invalid downlink RRC frame to the target 5G UE (e.g., smartphone) from a nearby malicious gNB. During
the <span 
class="ptmri8t-">RRC Attach Procedure</span>, the attacker (malicious gNB) sends one <span 
class="ptmri8t-">RRC Connection Setup </span>and one normal <span 
class="ptmri8t-">RRC Connection Setup </span>in a
specific sequence. The <span 
class="ptmbi8t-">15th byte </span>of the downlink transport block was changed from <span 
class="ptmri8t-">0xE0 </span>to <span id="textcolor94"><span 
class="ptmbi8t-">0xC4</span></span> (See this byte highlighted in red in the
Figure&#x00A0;<a 
onclick="document.getElementById(this.href.split(`#`)[1]).scrollIntoView();" href="#x1-27001r22">22<!--tex4ht:ref: fig:v16 --></a>). This corresponds to changing many fields within the RRC payload such as <span id="textcolor95"><span 
class="ptmbi8t-">Optional Field Bit</span></span> which indicates the
present of the <span id="textcolor96"><span 
class="ptmbi8t-">spCellConfig</span></span> from 0x01 to <span id="textcolor97"><span 
class="ptmbi8t-">0x00</span></span> and <span id="textcolor98"><span 
class="ptmbi8t-">cellGroupId</span></span> from 0x00 to <span id="textcolor99"><span 
class="ptmbi8t-">0x02</span></span>. After such invalid packet is sent
to the 5G UE, the <span 
class="ptmri8t-">Dimensity 900 </span>5G modem fails and reboots, indicating a firmware crash/assert in the Android logs
(logcat). More specifically, the modem temporarily hangs and performs a reboot in <span 
class="ptmbi8t-">2 to 7 seconds</span>. Due to arbitrary
combinations of normal and malicious connection sequences, logcat outputs either one of the following two firmware assert
messages:
</p><!--l. 706--><p class="indent" >  <q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [Fatal error(MPU_NOT_ALLOW)] err_code1:0x0000001D err_code2:0x910885CE err_code3:0x910885CA
</q-banner> </p>
<div class="center" 
>
<!--l. 706--><p class="noindent" >
</p><!--l. 706--><p class="noindent" ><span 
class="ptmb8t-">OR</span></p></div>
<!--l. 706--><p class="noindent" ><q-banner inline-actions dense rounded dark class="text-red text-center bg-grey-3" style="border-radius: 10px 10px 10px 10px;border-style: dotted;border-color: black;font-family:monospace;"><template v-slot:avatar><q-icon name="bug_report" color="red" /></template> [Fatal error(MPU_NOT_ALLOW)] err_code1:0x0000001D err_code2:0x910885AC err_code3:0x910885A8
</q-banner>
</p><!--l. 708--><p class="noindent" > <span 
class="ptmb8t-"><q-chip outline style="width: 100px; " square color="deep-orange" text-color="white" icon="warning">IMPACT</q-chip>  </span><span 
class="ptmri8t-">The attacker can block 3GPP Modem connectivity by continuously sending such malformed packet</span>. Furthermore, this
vulnerability is fairly easy to trigger since no information about the target&#8217;s SIM card information is required to launch the attack. This is
because the invalid downlink frame is sent <span 
class="ptmri8t-">during </span>the RRC attach procedure, which happens before any NAS authentication
procedure.
</p>
  <div style="margin-top:30px;margin-bottom:30px;" class="row items-start justify-center text-center"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-27001r22"></a>
                                                                                                
                                                                                                
<div class="center" 
>
<!--l. 717--><p class="noindent" >
</p><!--l. 719--><p class="noindent" > <img 
src="figures/attack-v16.pdf.svg" alt="PIC"  
width="1000" class="big-figure" height="auto"  />
<br /> </p><div class="caption" 
><span class="id">Figure&#x00A0;22: </span><span  
class="content">Invalid RRC CellGroupConfig.</span></div><!--tex4ht:label?: x1-27001r22 -->
</div>
                                                                                                
                                                                                                
  </div></div>
                                                                                                
                                                                                                
  <h3 class="likesectionHead"><a 
 id="x1-280007.12"></a>Acknowledgments</h3>
<!--l. 315--><p class="noindent" >This research was partially supported by <a 
target="_blank" href="https://fcp.sutd.edu.sg" >Future Communications
Program</a> hosted at Singapore University of Technology and
Design and <a 
target="_blank" href="https://itrust.sutd.edu.sg/nsoe-destsci/" >iTrust National Satellite of Excellence (NSOE) on
Design Science and Technology for Secure Critical Infrastructure</a>
(IoT Sector). We thank <a 
target="_blank" href="https://sakshiudeshi.github.io/" >Sakshi Udeshi</a> for coining the term
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;. We thank <a 
target="_blank" href="https://sg.linkedin.com/in/rushatichakraborty" >Rushati Chakraborty</a> for designing the
<span 
class="ptmri8t-">5Ghoul</span>&#x00A0;&#x00A0;logo (Ghost icon by <a 
target="_blank" href="https://www.flaticon.com/free-icon/ghost_1227567" >Flaticon</a>). We greatly appreciate
the help from <a 
target="_blank" href="https://sg.linkedin.com/in/mao-ngo-66848a53" >Mao Ngo</a> in the Future Communications Lab, he
kindly lent us the 5G smartphones from his lab where we
found the first vulnerability. Finally, we are highly thankful
for the support of Qualcomm and MediaTek during the
coordinated disclosure process and generously awarding us for
our findings.
</p><!--l. 1--><p class="noindent" >
</p>
  <h3 class="likesectionHead"><a 
 id="x1-290007.12"></a>References</h3>
<!--l. 1--><p class="noindent" >
    </p><div class="thebibliography">
    <p class="bibitem" ><span class="biblabel">
  [1]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xopen5gs"></a>Open5GS  implementation  for  5G  Core  and  EPC.
    https://github.com/open5gs/open5gs,  2023.     [Online;
    accessed 04-Dec-2023].
    </p>
    <p class="bibitem" ><span class="biblabel">
  [2]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="X3gpp"></a>3GPP.     3GPP  Specifications  and  Technologies.
    <a 
target="_blank" href="https://www.3gpp.org/specifications.html/" target="_blank" class="url" >https://www.3gpp.org/specifications.html/</a>,           2023.
    [Online; accessed 06-Dec-2023].
    </p>
    <p class="bibitem" ><span class="biblabel">
  [3]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="X5g_ue_wisec2023"></a>Evangelos
    Bitsikas,  Syed  Khandker,  Ahmad  Salous,  Aanjhan
    Ranganathan,   Roger   Piqueras&#x00A0;Jover,   and   Christina
    Popper.      UE  security  reloaded:  Developing  a  5g
    standalone  user-side  security  testing  framework.    In
    <span 
class="ptmri8t-">Proceedings of the 16th ACM Conference on Security</span>
    <span 
class="ptmri8t-">and Privacy in Wireless and Mobile Networks</span>, WiSec
    &#8217;23,   page   121&#8211;132,   New   York,   NY,   USA,   2023.
    Association for Computing Machinery.
    </p>
    <p class="bibitem" ><span class="biblabel">
  [4]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XMM"></a>freedesktop.org.                            ModemManager.
    <a 
target="_blank" href="https://www.freedesktop.org/wiki/Software/ModemManager/" target="_blank" class="url" >https://www.freedesktop.org/wiki/Software/ModemManager/</a>,
    2023. [Online; accessed 01-Dec-2023].
    </p>                                                  <p class="bibitem" ><span class="biblabel">
                                                    [5]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XgarbeliniAutomatedFuzzing4G2022a"></a>Matheus&#x00A0;E.   Garbelini,   Zewen   Shang,   Sudipta
                                                       Chattopadhyay,  Sumei  Sun,  and  Ernest  Kurniawan.
                                                       Towards   Automated   Fuzzing   of   4G/5G   Protocol
                                                       Implementations Over the Air. In <span 
class="ptmri8t-">GLOBECOM 2022 -</span>
                                                       <span 
class="ptmri8t-">2022 IEEE Global Communications Conference</span>, pages
                                                       86&#8211;92, Rio de Janeiro, Brazil, December 2022. IEEE.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                    [6]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span>
                                                       <a 
 id="Xhussain5GReasonerPropertyDirectedSecurity2019"></a>Syed&#x00A0;Rafiul Hussain, Mitziu Echeverria, Imtiaz Karim,
                                                       Omar  Chowdhury,  and  Elisa  Bertino.    5GReasoner:
                                                       A  Property-Directed  Security  and  Privacy  Analysis
                                                       Framework  for  5G  Cellular  Network  Protocol.     In
                                                       <span 
class="ptmri8t-">Proceedings  of  the  2019  ACM  SIGSAC  Conference</span>
                                                       <span 
class="ptmri8t-">on Computer and Communications Security</span>, CCS &#8217;19,
                                                       pages 669&#8211;684, New York, NY, USA, November 2019.
                                                       Association for Computing Machinery.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                    [7]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XkarimOpeningPandoraBox2019"></a>Imtiaz
                                                       Karim,  Fabrizio  Cicala,  Syed&#x00A0;Rafiul  Hussain,  Omar
                                                       Chowdhury,  and  Elisa  Bertino.    Opening  Pandora&#8217;s
                                                       Box  through  ATFuzzer:  Dynamic  Analysis  of  AT
                                                       Interface  for  Android  Smartphones.    In  <span 
class="ptmri8t-">Proceedings</span>
                                                       <span 
class="ptmri8t-">of  the  35th  Annual  Computer  Security  Applications</span>
                                                       <span 
class="ptmri8t-">Conference</span>, ACSAC &#8217;19, pages 529&#8211;543, New York,
                                                       NY, USA, December 2019. Association for Computing
                                                       Machinery.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                    [8]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XkimBaseSpecComparativeAnalysis2021"></a>Eunsoo Kim, Dongkwan Kim, CheolJun Park, Insu
                                                       Yun,                              and                              Yongdae
                                                       Kim.   BaseSpec:  Comparative  Analysis  of  Baseband
                                                       Software and Cellular Specifications for L3 Protocols.
                                                       In <span 
class="ptmri8t-">Proceedings 2021 Network and Distributed System</span>
                                                       <span 
class="ptmri8t-">Security Symposium</span>, Virtual, 2021. Internet Society.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                    [9]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XkotuliakLTrackStealthyTracking2022"></a>Martin  Kotuliak,  Simon  Erni,  Patrick  Leu,  Marc
                                                       Roschlin,  and  Srdjan  &#x010C;apkun.     {LTrack}:  Stealthy
                                                       Tracking of Mobile Phones in {LTE}. In <span 
class="ptmri8t-">31st USENIX</span>
                                                       <span 
class="ptmri8t-">Security   Symposium   (USENIX   Security   22)</span>,   pages
                                                       1291&#8211;1306, 2022.
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                   [10]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xmediatek-december"></a>MediaTek.                                                December
                                                       2023             Product             Security             Bulletin.
                                                       <a 
target="_blank" href="https://corp.mediatek.com/product-security-bulletin/December-2023/" target="_blank" class="url" >https://corp.mediatek.com/product-security-bulletin/December-2023/</a>,
                                                       2023. [Online; accessed 04-Dec-2023].
                                                                                                
                                                                                                
    </p>
    <p class="bibitem" ><span class="biblabel">
 [11]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XnikaeinOpenAirInterfaceFlexiblePlatform2014"></a>Navid   Nikaein,   Mahesh&#x00A0;K.   Marina,   Saravana
    Manickam,   Alex   Dawson,   Raymond   Knopp,   and
    Christian   Bonnet.       OpenAirInterface:   A   Flexible
    Platform   for   5G   Research.      <span 
class="ptmri8t-">SIGCOMM   Comput.</span>
    <span 
class="ptmri8t-">Commun. Rev.</span>, 44(5):33&#8211;38, October 2014.
    </p>
    <p class="bibitem" ><span class="biblabel">
 [12]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xopenwrt-platform"></a>OpenWrt.  OpenWrt 22.03.4 - Service Release - 10
    April                                                                      2023.
    <a 
href="httpshttps://openwrt.org/releases/22.03/notes-22.03.4/" target="_blank" class="url" >httpshttps://openwrt.org/releases/22.03/notes-22.03.4/</a>,
    2023. [Online; accessed 04-Dec-2023].
    </p>
    <p class="bibitem" ><span class="biblabel">
 [13]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xqualcomm-december"></a>Qualcomm.     December  2023  Security  Bulletin.
    <a 
target="_blank" href="https://docs.qualcomm.com/product/publicresources/securitybulletin/december-2023-bulletin.html/" target="_blank" class="url" >https://docs.qualcomm.com/product/publicresources/securitybulletin/december-2023-bulletin.html/</a>,
    2023. [Online; accessed 04-Dec-2023].                    </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                   [14]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="Xcpe-platform"></a>Telit     Cinterion.             FT980-WW     Advanced
                                                       LTE/5G         Wireless         Router         Demo         Kit.
                                                       <a 
target="_blank" href="https://www.telit.com/support-tools/development-evaluation-kits/ft980/" target="_blank" class="url" >https://www.telit.com/support-tools/development-evaluation-kits/ft980/</a>,
                                                       2023. [Online; accessed 04-Dec-2023].
                                                       </p>
                                                       <p class="bibitem" ><span class="biblabel">
                                                   [15]<span class="bibsp">&#x00A0;&#x00A0;&#x00A0;</span></span><a 
 id="XVodafoneUnveilsPrototype"></a>Vodafone.        Vodafone   Unveils   Prototype   5G
                                                       Network    Built    on    a    Raspberry    Pi    Computer.
                                                       <a 
target="_blank" href="https://www.vodafone.com/news/technology/vodafone-unveils-prototype-5g-network-built-raspberry-pi-computer/" target="_blank" class="url" >https://www.vodafone.com/news/technology/vodafone-unveils-prototype-5g-network-built-raspberry-pi-computer/</a>,
                                                       2023. [Online; accessed 07-Dec-2023].
                                                  </p>
                                                       </div>
                                                     
</div>
<script>new Vue({el: "#q-app",data: function () {return {}},methods: {},beforeMount() {}})</script>
</body></html> 

                                                                                                
                                                                                                
                                                                                                


                                         
















